<div class="page-wrapper">
    <div class="page-content-tab-onbording">
       <div class="container-fluid">
          <div class="row">
             <div class="col-md-12">
                <div class="persnol-details">
                   <div class="d-flex justify-content-between mb-2" *ngIf="selectedMethod==''">
                      <div class="d-flex align-items-center" style="gap:15px">
                         <div class="">
                            <h5 class="mb-0">Employee Details</h5>
                         </div>
                      </div>
                   </div>
                   <div class="row">
                      <div class="col-md-8">
                         <div class="card-header p-0 pb-3 bg-white">
                            <h4 class="card-title ">Employee Creation</h4>
                            <p class="text-muted mb-0">Please ensure that all required fields are accurately filled out when creating employee profiles in our HR system. This will help us maintain up-to-date records and provide better support to our employees.</p>
                         </div>
                         <div class="card-body mt-5 p-0">
                            <div class="alert alert-light mb-0" role="alert">
                               <h4 class="alert-heading font-18">Download the Sample Excel File!</h4>
                               <p>Look for the sample file titled "Sample_Data.xlsx" and click on the download button to save it to your computer.</p>
                               <p>Take a moment to review the existing data in the Excel file. This will help you understand the structure and content of the data before making any updates.</p>
                               <p><span class="text-primary"><u><a class="text-primary" href="{{sampleFileUrl}}">download a sample Excel file</a></u> </span>, update its data, and upload it back with the updated content on our platform</p>
                            </div>
                         </div>
                         <div class="card-body mt-3 p-0">
                            <div class="alert alert-light mb-0 excel-uplode-file-box text-center">
                               <input id="fileSelect" type="file" name="img[]" accept=".xlsx" class="input">
                               <img src="assets/images/excel.svg" style="width:50px;" class="pb-3">
                               <p class="">Drag file here to <br> upload or <a href="#!"> choose file </a></p>
                               <!-- <div class="spinner-border text-success" role="status"></div> -->
                            </div>
                         </div>
                      </div>
                      <div class="col-md-4" >
                         <div class="card-body mt-130 bg-soft-warning">
                            <div class="pt-3">
                              <img src="assets/images/small/business.png" alt="" class="img-fluid px-3 mb-2">
                              <footer class="blockquote-footer font-14">Efficiency Redefined: <cite title="Source Title">Seamlessly Create Employees in Your Hajiri System </cite></footer>
                               <div class=" py-2">
                                  <button class="btn btn-outline-primary btn-square" data-bs-toggle="modal" data-bs-target="#munal-upload" type="button">Click Here To Create</button>
                               </div>
                            </div>
                         </div>
                      </div>
                      <ng-container *ngIf="loading">
                         <div class="">
                            <div class="text-end">
                               <ngx-shimmer-loading [width]="'30%'" [height]="'40px'"
                               style="border-radius: 50%"></ngx-shimmer-loading>
                            </div>
                         </div>
                         <div class="mt-3 mb-2" style="border: 1px solid #f5f5f5; padding:5px; border-radius: 6px;"
                            *ngFor="let number of [1,2,3,4,5]">
                            <div class="row mt-3">
                               <div class="col-md-2">
                                  <div class="">
                                     <ngx-shimmer-loading [width]="'100%'" [height]="'30px'"
                                     style="border-radius: 50%"></ngx-shimmer-loading>
                                  </div>
                               </div>
                               <div class="col-md-2">
                                  <div class="">
                                     <ngx-shimmer-loading [width]="'100%'" [height]="'30px'"
                                     style="border-radius: 50%"></ngx-shimmer-loading>
                                  </div>
                               </div>
                               <div class="col-md-3">
                                  <div class="">
                                     <ngx-shimmer-loading [width]="'100%'" [height]="'30px'"
                                     style="border-radius: 50%"></ngx-shimmer-loading>
                                  </div>
                               </div>
                               <div class="col-md-3">
                                  <div class="">
                                     <ngx-shimmer-loading [width]="'100%'" [height]="'30px'"
                                     style="border-radius: 50%"></ngx-shimmer-loading>
                                  </div>
                               </div>
                               <div class="col-md-2">
                                  <div class="">
                                     <ngx-shimmer-loading [width]="'100%'" [height]="'30px'"
                                     style="border-radius: 50%"></ngx-shimmer-loading>
                                  </div>
                               </div>
                            </div>
                         </div>
                      </ng-container>
                      <!-- *ngIf="selectedMethod=='' && !loading && onboardUserList.length>0" -->
                      <div class="row mt-4"  >
                         <div class="d-flex align-items-center justify-content-end mb-3 p-0">
                            <a type="button" class="btn add-excel"><i class="bi bi-file-earmark-excel" style="position: relative; top: -1px; padding-right: 6px;"></i> Excel Upload </a>
                            <p style="color: #d7d7d7; margin-bottom: 0px;" class="ng-star-inserted">|</p>
                            <a type="button" class="btn add-excel" data-bs-toggle="modal" data-bs-target="#munal-upload"><i class="bi bi-journal-check"></i> Manual Upload </a>
                         </div>
                         <table class="table">
                            <thead class="thead-light table-design">
                               <tr>
                                  <th style="width:5%" class="text-center">#</th>
                                  <th style="width:25%" class="text-left">Name</th>
                                  <th style="width:20%" class="text-left">Phone</th>
                                  <th style="width:25%" class="text-left">Email</th>
                                  <th style="width:20%" class="text-center">Action</th>
                               </tr>
                            </thead>
                            <tbody class="table-design">
                               <tr *ngFor="let onboardUser of onboardUserList; let i = index">
                                  <td>
                                     <p class="tableinfo mb-0 text-left"><b>{{i+1}}</b></p>
                                  </td>
                                  <td>
                                     <p class="tableinfo mb-0 text-left"><b>{{onboardUser.name}}</b>
                                     </p>
                                  </td>
                                  <td>
                                     <p class="tableinfo mb-0 text-left"><b>{{onboardUser.phone}}</b>
                                     </p>
                                  </td>
                                  <td>
                                     <p class="tableinfo mb-0 text-left"><b>{{onboardUser.email?
                                        onboardUser.email:"N/A" }}</b>
                                     </p>
                                  </td>
                                  <td class="d-flex justify-content-center gap-3">
                                     <p class="tableinfo mb-0 pointer text-center" style="color: darkblue;"
                                        (click)="openUserEditModal(onboardUser)">
                                        <i class="bi bi-pencil-square"></i>
                                     </p>
                                     <p class="tableinfo mb-0 pointer text-center text-danger mb-2"
                                        (click)="deleteUser(onboardUser.id)">
                                        <i class="bi bi-trash text-danger" ></i>
                                     </p>
                                  </td>
                               </tr>
                            </tbody>
                         </table>
                      </div>
                     
                </div>
                <div class="">
                   <div class="next-btn-box d-flex align-items-center justify-content-between">
                      <button class="btn btn-outline-secondary btn-round" type="button" (click)="backPage()"><i class="bi bi-arrow-left"></i>  Previous </button>
                      <button type="submit" class="btn btn-outline-primary btn-round" (click)="next()">
                         <span *ngIf="!loading">Next <i class="bi bi-arrow-right"
                            style="padding-left: 8px;"></i></span>
                         <div class="dot-opacity-loader" *ngIf="loading">
                            <span></span>
                            <span></span>
                            <span></span>
                         </div>
                      </button>
                   </div>
                </div>
             </div>
          </div>
       </div>
    </div>
   
    <!-- user edit modal -->
    <button #userEditModal class="d-none" data-bs-toggle="modal" data-bs-target="#editUser"></button>
    <div class="modal fade" id="editUser" tabindex="-1" role="dialog" aria-hidden="true">
       <div class="modal-dialog modal-lg" role="document">
          <div class="modal-content">
             <div class="modal-header">
                <h5 class="modal-title">Edit User</h5>
                <button type="button" #closeUserEditModal class="btn-close" data-bs-dismiss="modal"
                   aria-label="Close"></button>
             </div>
             <div class="modal-body">
                <form #editUserForm="ngForm">
                   <div class="form-group row mb-3">
                      <div class="col-md-4">
                         <label class="mb-2"> Name</label>
                         <input type="text" name="Name" [(ngModel)]="user.name" class="form-control"
                         placeholder="Enter Name" required>
                      </div>
                      <div class="col-md-4">
                         <label class="mb-2">Phone Number</label>
                         <input type="tel" name="phone" [(ngModel)]="user.phone" placeholder="Phone Number"
                         minlength="10" maxlength="10" class="form-control"
                         oninput="this.value = this.value.replace(/^[^1-9]/g, '').replace(/(\..*)\./g, '$1');"
                         (keyup)="checkNumberExistance(-1,user.phone, user.uuid)" required>
                         <p *ngIf="isNumberExist" class="error text-danger">This number
                            already exist
                         </p>
                      </div>
                      <div class="col-md-4">
                         <label class="mb-2">Email </label>
                         <input type="email" name="email" [(ngModel)]="user.email" placeholder="Email"
                         class="form-control" (keyup)="checkEmailExistance(-1,user.email,user.uuid)">
                         <p *ngIf="isEmailExist" class="error text-danger">This email already exist</p>
                      </div>
                   </div>
                   <div class="d-flex justify-content-end">
                      <button type="submit" class="btn btn-success"
                      [disabled]="editUserForm.invalid || isNumberExist || isEmailExist" (click)="editUser()">
                      <span *ngIf="!editLoader">Submit</span></button>
                      <div class="dot-opacity-loader" *ngIf="editLoader">
                         <span></span>
                         <span></span>
                         <span></span>
                      </div>
                   </div>
                </form>
             </div>
          </div>
       </div>
    </div>
    <!-- user edit modal -->
    <button class="d-none" data-bs-toggle="modal" data-bs-target="#munal-upload"></button>
    <div class="modal fade" id="munal-upload" tabindex="-1" role="dialog" aria-hidden="true">
       <div class="modal-dialog modal-dialog-centered" style="max-width: 700px;"  role="document">
          <div class="modal-content">
             <div class="modal-header">
                <h5 class="modal-title">Manual Upload</h5>
                <button type="button" #closeUserEditModal class="btn-close" data-bs-dismiss="modal"
                   aria-label="Close"></button>
             </div>
             <div class="modal-body munal-deta-upload-modal">
                <div class="row" *ngFor="let user of userList; let i = index">
                   <div class="col-md-4">
                      <div class="mb-3">
                         <label class="mb-2"> Name <span class="text-optional">*</span></label>
                         <input type="text" name="userName{{i}}" [(ngModel)]="user.name"
                         class="form-control profile-input" placeholder="Enter Employee Name" #name="ngModel"
                         required>
                         <div *ngIf="name?.dirty || isFormInvalid">
                            <p class="errortxt mt-2 mb-2"
                               *ngIf="name.errors?.required">
                               <i class="bi bi-exclamation-circle"></i> Name is required.
                            </p>
                            <p class="errortxt mt-2 mb-2"
                               *ngIf="name.errors?.minlength">
                               <i class="bi bi-exclamation-circle"></i> Please enter minimum five characters name.
                            </p>
                         </div>
                      </div>
                   </div>
                   <div class="col-md-4">
                      <div class="mb-3">
                         <label class="mb-2">Phone Number <span
                            class="text-optional">*</span></label>
                         <input type="tel" name="userPhone{{i}}" [(ngModel)]="user.phone"
                         placeholder="Enter Whatsapp Number" minlength="10" maxlength="10"
                         class="form-control profile-input" (keyup)="checkNumberExistance(i,user.phone, user.uuid)"
                         #phone="ngModel" required>
                         <p *ngIf="userList[i].isPhoneExist" class="error text-danger">this number
                            already exist
                         </p>
                         <div *ngIf="phone?.dirty || isFormInvalid">
                            <p class="errortxt mt-2 mb-2"
                               *ngIf="phone.errors?.required">
                               <i class="bi bi-exclamation-circle"></i> Phone is required.
                            </p>
                            <p class="errortxt mt-2 mb-2"
                               *ngIf="phone.errors?.minlength">
                               <i class="bi bi-exclamation-circle"></i> Please enter a valid phone
                               address.
                            </p>
                         </div>
                      </div>
                   </div>
                   <div class="col-md-4">
                      <div class="mb-3">
                         <label class="mb-2">Email</label>
                         <input type="email" name="userEmail{{i}}" [(ngModel)]="user.email"
                         #email="ngModel" placeholder="Enter Email" class="form-control profile-input"
                         (keyup)="checkEmailExistance(i,user.email, user.uuid)" >
                         <p *ngIf="userList[i].isEmailExist" class="error text-danger">this email
                            already exist
                         </p>
                         <div *ngIf="email?.dirty || isFormInvalid">
                            <p class="errortxt mt-2 mb-2"
                               *ngIf="email.errors?.required">
                               <i class="bi bi-exclamation-circle"></i> Email Id is required.
                            </p>
                            <p class="errortxt mt-2 mb-2" *ngIf="email.errors?.email">
                               <i class="bi bi-exclamation-circle"></i> Please enter a valid email
                               address.
                            </p>
                         </div>
                         <div class="leave-delet-btn pointer position-absolute" (click)="removeUser(i)" *ngIf="i>0">
                         <i class="bi bi-trash"></i>
                      </div>
                   </div>
                </div>
             </div>
             <div class=" col-md-12" >
                <div class="" style="margin-top: -10px;">
                   <a (click)="addUser()" class="munal-add-more-btn"><i class="bi bi-plus" style="font-size: 20px;"></i> Add new user</a>
                </div>
             </div>
          </div>
          <div class="modal-footer">
             <button class="btn btn-primary" type="button" (click)="submit()"
             [disabled]="isNumberExist || isEmailExist"> <span *ngIf="!createLoading">Submit</span></button>
          </div>
       </div>
    </div>
 </div>