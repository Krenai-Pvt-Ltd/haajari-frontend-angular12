<div class="page-wrapper">
  <!-- Page Content-->
  <div class="page-content-tab">
    <div class="container-fluid">
      <div class="row leave-management-settings p-3 mt-2 align-items-center" *ngIf="mainPlaceholderFlag">
        <div class="col-md-6">
          <div class="leave-management-detail pt-5 pb-5">
            <h3 class="mb-3">
              Generate <br />
              Employee Salary Slips
            </h3>
            <p class="mb-0 font-14">
              Manage and track all employee bonuses and <br />
              available discounts in one place.
            </p>

            <!-- <button class="btn add-leave-btn mt-4 mb-2">Add New Members</button> -->

            <hr />
            <span class="mb-0">
              By signing, you are creating
              <a href="#!">
                Learn more about it
                <svg
                  xmlns="http://www.w3.org/2000/svg"
                  width="20"
                  height="21"
                  viewBox="0 0 20 21"
                  fill="none"
                >
                  <mask
                    id="mask0_4244_1588"
                    style="mask-type: alpha"
                    maskUnits="userSpaceOnUse"
                    x="0"
                    y="0"
                    width="20"
                    height="21"
                  >
                    <rect y="0.546875" width="20" height="20" fill="#6666F2" />
                  </mask>
                  <g mask="url(#mask0_4244_1588)">
                    <path
                      d="M4.50016 17.2148L3.3335 16.0482L13.0002 6.38151H7.50016V4.71484H15.8335V13.0482H14.1668V7.54818L4.50016 17.2148Z"
                      fill="#6666F2"
                    />
                  </g>
                </svg>
              </a>
            </span>
          </div>
        </div>
        <div class="col-md-6">
          <div class="leave-management-detail-img text-end">
            <img src="assets/images/esi-epf-img.svg" style="width: 380px" />
          </div>
        </div>
      </div>

      <div class="col-12 mt-4" *ngIf="!mainPlaceholderFlag">
        <!-- Left sidebar -->
        <div
          class="d-flex align-items-center"
          style="border: 1px solid #f1f1f1"
        >
          <div style="width: 20%; position: relative">
            <div class="dropdown bonus-payroll">
              <nz-date-picker
                nzMode="month"
                [nzSize]="size"
                [(ngModel)]="selectedDate"
                (ngModelChange)="onMonthChange($event)"
                [nzDisabledDate]="disableMonths"
              ></nz-date-picker>
            </div>
          </div>

          <div
            class="search-bar-wrapper"
            style="display: flex; align-items: center; width: 100%"
          >
            <div class="" style="flex-grow: 1">
              <form
                role="search"
                class="searching ng-untouched ng-pristine ng-valid"
                (submit)="searchUsers($event)"
              >
                <div class="form-group" style="position: relative; width: 100%">
                  <input
                    type="text"
                    id="searchText"
                    placeholder="Search"
                    class="form-control me-2 ng-untouched ng-pristine ng-valid attendance-details-search"
                    style="padding: 10px 40px; padding-right: 20px"
                    (keyup)="searchUsers($event)"
                    [(ngModel)]="search"
                    [ngModelOptions]="{ standalone: true }"
                  />
                  <i
                    class="bi bi-search search-icon"
                    style="
                      position: absolute;
                      left: 15px;
                      top: 50%;
                      transform: translateY(-50%);
                    "
                  ></i>
                  <button
                    *ngIf="search.length !== 0"
                    type="button"
                    class="btn close-btn"
                    (click)="clearSearch()"
                    style="
                      position: absolute;
                      right: 20px;
                      top: 50%;
                      transform: translateY(-50%);
                    "
                  >
                    <i class="bi bi-x mt-auto mb-auto"></i>
                  </button>
                </div>
              </form>
            </div>
            <div
              class="filter-wrapper"
              style="display: flex; align-items: center; margin-left: 20px"
            >
              <!-- Display this only if there are selected staff -->
              <a class="info-button" *ngIf="selectedEmployeeIds.length > 0">
                {{ selectedEmployeeIds.length }} selected of {{ total }}
              </a>
              <!-- Clear button shows only if there are selected staff -->
              <span
                class="clear-button text-danger"
                *ngIf="selectedEmployeeIds.length > 0"
                (click)="unselectAllUsers()"
                style="margin-left: 10px"
              >
                Clear all users <i class="bi bi-x"></i>
              </span>
              <label class="checkbox-label" style="margin-left: 10px">
                <input
                  type="checkbox"
                  [checked]="isAllUsersSelected"
                  (change)="selectAllUsers($event)"
                />
                Select all
              </label>
            </div>
          </div>
        </div>
        <!-- <div class="email-leftbar">
          <small>Teams</small>
          <ul class="list-group">
            <li
              class="list-group-item d-flex justify-content-between align-items-center"
            >
              <div>
                <i
                  class="la la-arrow-right text-secondary me-2 text-muted font-16 me-2"
                ></i
                >Krenai
              </div>
              <span class="badge badge-outline-primary badge-pill">4</span>
            </li>
            <li
              class="list-group-item d-flex justify-content-between align-items-center"
            >
              <div>
                <i
                  class="la la-arrow-right text-secondary me-2 text-muted font-18 me-2"
                ></i
                >Credily
              </div>

              <span class="badge badge-outline-primary badge-pill">4</span>
            </li>
            <li
              class="list-group-item d-flex justify-content-between align-items-center"
            >
              <div>
                <i
                  class="la la-arrow-right text-secondary me-2 text-muted font-16 me-2"
                ></i
                >Hajiri
              </div>
              <span class="badge badge-outline-primary badge-pill">4</span>
            </li>
            <li
              class="list-group-item d-flex justify-content-between align-items-center"
            >
              <div>
                <i
                  class="la la-arrow-right text-secondary me-2 text-muted font-16 me-2"
                ></i
                >1PYQ
              </div>
              <span class="badge badge-outline-primary badge-pill">4</span>
            </li>
            <li
              class="list-group-item d-flex justify-content-between align-items-center"
            >
              <div>
                <i
                  class="la la-arrow-right text-secondary me-2 text-muted font-16 me-2"
                ></i
                >Wekreta
              </div>
              <span class="badge badge-outline-info badge-pill">1</span>
            </li>
          </ul>
          <p></p>
          <small class="pt-4">Locations</small>
          <ul class="list-group">
            <li
              class="list-group-item d-flex justify-content-between align-items-center"
            >
              <div>
                <i
                  class="la la-arrow-right text-secondary me-2 text-muted font-16 me-2"
                ></i
                >Sector 67
              </div>
              <span class="badge badge-outline-primary badge-pill">4</span>
            </li>
            <li
              class="list-group-item d-flex justify-content-between align-items-center"
            >
              <div>
                <i
                  class="la la-arrow-right text-secondary me-2 text-muted font-18 me-2"
                ></i
                >Sector 44
              </div>

              <span class="badge badge-outline-primary badge-pill">4</span>
            </li>
          </ul>

    
        </div> -->
        <!-- email-rightbar -->
        <div class="">
          <!-- end div -->
          <div class="btn-toolbar" role="toolbar" *ngIf="selectedEmployeeIds.length>0">
            <div class="btn-group">
              <!-- <button type="button" class="btn btn-de-secondary">
                <i class="fas fa-cog"></i>
                <small>&nbsp;&nbsp;RELEASE PAYROLL</small>
              </button> -->
              <button
                [disabled]="
                  !selectedEmployeeIds || selectedEmployeeIds.length === 0
                "
                type="button"
                class="btn btn-de-secondary"
                (click)="updatePayActionTypeFoUsersMethodCall('HOLD SALARY')"
                style="cursor: pointer"
              >
                <i class="fas fa-exclamation-circle"></i>
                <small>&nbsp;&nbsp;Hold Payslip</small>
              </button>
              <button
                type="button"
                class="btn btn-de-secondary"
                (click)="sendPayslipPdf('email')"
              >
                <i class="fas fa-envelope-open"></i>
                <small>&nbsp;&nbsp;Send By Mail</small>
              </button>
              <button
                type="button"
                class="btn btn-de-secondary"
                (click)="sendPayslipPdf('whatsapp')"
              >
                <i class="fab fa-whatsapp"></i>
                <small>&nbsp;&nbsp;Send By WhatsApp</small>
              </button>
              <button
                type="button"
                class="btn btn-de-secondary"
                (click)="sendPayslipPdf('slack')"
              >
                <i class="fab fa-whatsapp"></i>
                <small>&nbsp;&nbsp;Send By Slack</small>
              </button>
            </div>
            <div class="btn-group ms-1">
              <button
                [disabled]="
                  !selectedEmployeeIds || selectedEmployeeIds.length === 0
                "
                type="button"
                class="btn btn-de-secondary"
                (click)="generateSalarySlipMethodCall()"
              >
                <i class="fas fa-cogs"></i>
                <small>&nbsp;&nbsp;Generate</small>
              </button>
            </div>
          </div>
          <!-- end toolbar -->
          <div class="card my-3">
            <div class="table-responsive">
              <table class="table border-dashed mb-0">
                <thead>
                  <tr>
                    <th></th>
                    <th>NAME</th>
                    <th>EMAIL</th>
                    <th>DEPARTMENT</th>
                    <th>PAY ACTION</th>
                    <th>PAYSLIP STATUS</th>
                    <th>ACTION</th>
                  </tr>
                </thead>
                <ng-container
                  *ngIf="
                    isShimmer &&
                      employeeMonthWiseSalaryDataList.length === 0 &&
                      !dataNotFoundPlaceholder &&
                      !networkConnectionErrorPlaceHolder;
                    else attendanceDataCondition
                  "
                >
                  <tbody>
                    <tr *ngFor="let item of [].constructor(6)">
                      <td class="text-center">
                        <ngx-shimmer-loading
                          [width]="'100%'"
                          [height]="'10px'"
                        ></ngx-shimmer-loading>
                      </td>
                      <td class="text-center">
                        <ngx-shimmer-loading
                          [width]="'%'"
                          [height]="'10px'"
                        ></ngx-shimmer-loading>
                      </td>
                      <td class="text-center">
                        <ngx-shimmer-loading
                          [width]="'70%'"
                          [height]="'10px'"
                        ></ngx-shimmer-loading>
                      </td>
                      <td class="text-center">
                        <ngx-shimmer-loading
                          [width]="'70%'"
                          [height]="'10px'"
                        ></ngx-shimmer-loading>
                      </td>
                      <td class="text-center">
                        <ngx-shimmer-loading
                          [width]="'70%'"
                          [height]="'10px'"
                        ></ngx-shimmer-loading>
                      </td>
                      <td class="text-center">
                        <ngx-shimmer-loading
                          [width]="'70%'"
                          [height]="'10px'"
                        ></ngx-shimmer-loading>
                      </td>
                      <td class="text-center">
                        <ngx-shimmer-loading
                          [width]="'70%'"
                          [height]="'10px'"
                        ></ngx-shimmer-loading>
                      </td>
                      <td class="text-center">
                        <ngx-shimmer-loading
                          [width]="'70%'"
                          [height]="'10px'"
                        ></ngx-shimmer-loading>
                      </td>
                      <td class="text-center">
                        <ngx-shimmer-loading
                          [width]="'70%'"
                          [height]="'10px'"
                        ></ngx-shimmer-loading>
                      </td>
                    </tr>
                  </tbody>
                </ng-container>

                <ng-template #attendanceDataCondition>
                  <ng-container
                    *ngIf="
                      employeeMonthWiseSalaryDataList.length !== 0 &&
                        !dataNotFoundPlaceholder &&
                        !networkConnectionErrorPlaceHolder;
                      else errorConditionWhileFetchingEmployeeSalaryData
                    "
                  >
                    <tbody>
                      <tr
                        *ngFor="let employee of employeeMonthWiseSalaryDataList"
                      >
                        <td>
                          <input
                            type="checkbox"
                            [checked]="
                              selectedEmployeeIds.includes(employee.uuid)
                            "
                            (change)="selectUser(employee)"
                          />
                        </td>
                        <td>{{ employee.name ? employee.name : "-" }}</td>
                        <td>{{ employee.email ? employee.email : "-" }}</td>
                        <td>
                          {{ employee.department ? employee.department : "-" }}
                        </td>
                        <td>
                          <span
                            class="badge rounded-pill"
                            [ngClass]="{
                              'badge-soft-success':
                                !employee.payActionType ||
                                employee.payActionType === 'PROCESS AS SALARY',
                              'badge-soft-danger':
                                employee.payActionType === 'HOLD SALARY'
                            }"
                          >
                            {{
                              employee.payActionType
                                ? employee.payActionType
                                : "PROCESS AS SALARY"
                            }}
                          </span>
                        </td>
                        <td>
                          <span
                            class="badge rounded-pill"
                            [ngClass]="{
                              'badge-soft-success':
                                employee.payStatusName === 'APPROVED',
                              'badge-soft-warning':
                                employee.payStatusName === 'PENDING'
                            }"
                          >
                            {{
                              employee.payStatusName
                                ? employee.payStatusName
                                : "-"
                            }}
                          </span>
                        </td>
                        <td>
                          <div
                            class="btn-group"
                            role="group"
                            aria-label="Basic example"
                          >
                            <button
                              type="button"
                              class="btn btn-light"
                              ngbTooltip="Download"
                              placement="top"
                              (click)="downloadPdf(employee.paySlipUrl)"
                              [disabled]="!employee.paySlipUrl"
                            >
                              <i class="ti ti-download"></i>
                            </button>
                            <button
                              type="button"
                              class="btn btn-light"
                              ngbTooltip="View"
                              placement="top"
                              (click)="viewPdf(employee.paySlipUrl)"
                              [disabled]="!employee.paySlipUrl"
                            >
                              <i class="ti ti-eye"></i>
                            </button>
                            <button
                              type="button"
                              class="btn btn-light"
                              ngbTooltip="Send"
                              placement="top"
                              (click)="
                                sendPayslipPdf(
                                  'email',
                                  employeeMonthWiseSalaryDataList
                                )
                              "
                              [disabled]="!employee.paySlipUrl"
                            >
                              <i class="ti ti-send"></i>
                            </button>
                          </div>
                        </td>
                      </tr>
                    </tbody>
                  </ng-container>
                </ng-template>
              </table>

              <!--end /table-->
            </div>
            <ng-template #errorConditionWhileFetchingEmployeeSalaryData>
              <tbody>
                <tr>
                  <td colspan="8">
                    <div
                      class="empty-file"
                      style="margin-top: 2%; margin-bottom: 2%"
                      *ngIf="dataNotFoundPlaceholder"
                    >
                      <nz-empty
                        nzNotFoundImage="assets/images/no-data-found-img-2.svg"
                        [nzNotFoundContent]="contentTpl"
                      >
                        <ng-template #contentTpl>
                          <p class="mb-1 empty-detail font-16">
                            No data for now
                          </p>
                        </ng-template>
                      </nz-empty>
                    </div>

                    <div
                      class="empty-file"
                      style="margin-top: 3%; margin-bottom: 3%"
                      *ngIf="networkConnectionErrorPlaceHolder"
                    >
                      <nz-empty
                        nzNotFoundImage="assets/images/no-data-found-img-2.svg"
                        [nzNotFoundContent]="contentTpl"
                      >
                        <ng-template #contentTpl>
                          <p class="mb-1 empty-detail font-16">
                            Something went wrong
                          </p>
                        </ng-template>
                      </nz-empty>
                    </div>
                  </td>
                </tr>
              </tbody>
            </ng-template>
          </div>
          <!-- Pagination -->
          <div
            class="pagination pl-3 align-items-center justify-content-between"
            *ngIf="
              (total > itemPerPage - 1 ||
                (pageNumber === lastPageNumber && lastPageNumber !== 1)) &&
              !dataNotFoundPlaceholder &&
              !networkConnectionErrorPlaceHolder
            "
          >
            <p style="padding-left: 15px">
              Showing {{ getStartIndex() }} - {{ getEndIndex() }} of
              {{ total }} employees
            </p>
            <div>
              <nav aria-label="Page navigation example">
                <ul class="pagination justify-content-end">
                  <li class="page-item" [class.disabled]="pageNumber == 1">
                    <a
                      class="page-link"
                      href="javascript:void(0);"
                      aria-label="Previous"
                      (click)="changePage('prev')"
                    >
                      <span aria-hidden="true">&laquo;</span>
                    </a>
                  </li>
                  <li
                    class="page-item"
                    *ngFor="let page of getPages()"
                    [class.active]="pageNumber == page"
                  >
                    <a
                      class="page-link"
                      href="javascript:void(0);"
                      (click)="changePage(page)"
                      >{{ page }}</a
                    >
                  </li>
                  <li
                    class="page-item"
                    [class.disabled]="pageNumber == totalPages"
                  >
                    <a
                      class="page-link"
                      href="javascript:void(0);"
                      aria-label="Next"
                      (click)="changePage('next')"
                    >
                      <span aria-hidden="true">&raquo;</span>
                    </a>
                  </li>
                </ul>
              </nav>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>
