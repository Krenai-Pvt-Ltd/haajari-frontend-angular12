<div class="page-wrapper">
    <div class="page-content-tab">
        <div class="container-fluid ">
           <div class="row">
                <div class="col-md-12 mt-3">
                    <ul id="pills-tab" role="tablist" class="nav nav-pills ">
                        <li class="nav-item">
                        <a id="pills-announcement-tab" data-bs-toggle="pill" href="#dashboard" role="tab" 
                            aria-controls="pills-dashboard" aria-selected="false" (click)="fetchDashboardData()" 
                            class="nav-link active">Dashboard</a>
                        </li>
                        <li class="nav-item d-flex align-items-center">
                        <a id="pills-notification-tab" data-bs-toggle="pill" href="#expense-request" role="tab"
                            aria-controls="pills-request" aria-selected="false" (click)="expenseRequest()"
                            class="nav-link">Expense Request </a>
                            <span *ngIf="status13Count > 0" class="request-count d-flex align-items-center justify-content-center">{{status13Count}}</span>
                        </li>
                        <li class="nav-item d-flex align-items-center">
                            <a id="pills-notification-tab" data-bs-toggle="pill" href="#expense-policy" role="tab"
                                aria-controls="pills-request" aria-selected="false"
                                class="nav-link">Company Expense Policy</a>
                        </li>
                        <li class="nav-item d-flex align-items-center">
                            <a id="pills-notification-tab" data-bs-toggle="pill" href="#expense-wallet" role="tab"
                                aria-controls="pills-request" aria-selected="false" (click)="companyWalletRequest()"
                                class="nav-link">Company Wallet</a>
                        </li>
                    </ul>
                    <div id="pills-tabContent" class="tab-content">
                        <div class="tab-pane active show" id="dashboard" role="tabpanel" aria-labelledby="employee-tab">
                            <div class="row mt-3 ">
                                <div class="col-md-28">
                                    <div class="expense-report">
                                        <div class="date-range d-flex align-items-center justify-content-between p-2">
                                            <h5 class="mb-0 font-14 fw-normal">Date Range</h5>
                                            <div class="d-flex align-items-center attendance-date bg-white border-rounded-2">
                                                
                                                <!-- Date Range Picker -->
                                                <div class="dropdown">
                                                    <nz-range-picker nzBorderless  class="form-control  w-100 placeholder-lines"
                                                        [(ngModel)]="selectedDateRange" 
                                                        [nzSize]="'small'" 
                                                        (ngModelChange)="onDateRangeChange($event)">
                                                    </nz-range-picker>
                                                </div>
                                            
                                            </div>
                                            
                                        </div>
                                        <div class="mt-3 expense-chart p-3">
                                            <h5 class="mb-0 font-13 fw-semibold">Wallet Details</h5>
                                            <div class="mt-3 mb-3 expense-wallet" style="background-image: url(../assets/images/sidebar-icon/wallet-img.png);">
                                                <div class="p-3">
                                                    <h5 class="font-13 fw-normal ">Company  Wallet</h5>
                                                    <h5 class="mb-1 font-14 fw-semibold mt-4">Total Recharge Amount</h5>
                                                    <h3 class="mb-3 font-16 fw-bold text-black">₹{{creditWalletAmount}}</h3>
                                                </div>
                                                <div class="d-flex align-items-center justify-content-between expense-spending p-3">
                                                    <p class="mb-0 font-14 fw-normal">Total Used Amount</p>
                                                    <h5 class="mb-0 font-14 fw-semibold ">₹{{debitWalletAmount}}</h5>
                                                </div>
                                            </div>
                                            <!-- <div class="mt-3 mb-3">
                                                <img src="assets/images/sidebar-icon/expense-ellocation-chart.svg" class="w-100">
                                            </div> -->
                                            <hr>

                                            <h5 class="mb-0 font-14 fw-semibold color-basic">Employee Wallet Balance</h5>
                                            <!-- <h5 class="mb-0 font-14 fw-normal color-basic">Employee Transactions</h5> -->
                                            <div class="wallet-transactions-list mt-4">
                                                <div class="empty-file" style="margin-top: 5%; margin-bottom: 5%" *ngIf="walletUserList.length == 0 && !loading">
                                                    <nz-empty nzNotFoundImage="assets/images/no-data-found-img.svg"
                                                      [nzNotFoundContent]="contentTpl">
                                                      <ng-template #contentTpl>
                                                        <p class="mb-1 empty-detail font-14">
                                                          No data for now
                                                        </p>
                                                      </ng-template>
                                                    </nz-empty>
                                                </div>

                                              
                                                <div *ngIf="loading">
                                                    <div class="d-flex align-items-center justify-content-between mb-4" *ngFor="let item of [].constructor(6)">
                                                      <!-- Left: User image and info -->
                                                      <div class="d-flex align-items-center gap-2">
                                                        <ngx-shimmer-loading [width]="'40px'" [height]="'40px'" [borderRadius]="'50%'"></ngx-shimmer-loading>
                                                        <div>
                                                          <ngx-shimmer-loading [width]="'120px'" [height]="'14px'" class="mb-2"></ngx-shimmer-loading>
                                                          <ngx-shimmer-loading [width]="'160px'" [height]="'10px'"></ngx-shimmer-loading>
                                                        </div>
                                                      </div>
                                                  
                                                      <!-- Right: Wallet amount and date -->
                                                      <div class="text-end">
                                                        <ngx-shimmer-loading [width]="'80px'" [height]="'14px'" class="mb-2"></ngx-shimmer-loading>
                                                        <ngx-shimmer-loading [width]="'60px'" [height]="'10px'"></ngx-shimmer-loading>
                                                      </div>
                                                    </div>
                                                  </div>
                                                <div class="d-flex align-items-center justify-content-between mb-4" *ngFor="let user of walletUserList">
                                                    <div class="d-flex align-items-center gap-2 ">
                                                        <img onerror="this.src='./assets/images/broken-image-icon.jpg';" [src]="user.imageUrl || 'assets/images/user.png'" class="img-40 radius-50 object-fit-cover">
                                                        <div>
                                                            <h5 (click)="this.helperService.routeToUserProfile(user.uuid)"class="mb-1 cursor font-14 fw-semibold pointer">{{user.userName}}</h5>
                                                            <p class="mb-0 fw-light font-12">Department | <span class="text-black fw-normal">{{user.department}}</span></p>
                                                        </div>
                                                    </div>
                                                    <div class="text-end">
                                                        <h5 class="mb-1 font-14 fw-semibold">₹{{user.walletAmount}}</h5>
                                                        <p class="mb-0 fw-light font-12 color-basic">{{ user.lastTransactionDate | date: 'MMM dd' }}</p>
                                                    </div>
                                                </div>
                                            </div>

                                        </div>
                                    </div>
                                </div>
                                <div class="col-md-72">
                                        <div class="row">
                                            <div class="col-md-3">
                                                <div class="total-expanse p-3 border-rounded-2">
                                                    <div class="d-flex align-items-center gap-2">
                                                        <span class="total-expanse-icon d-flex align-items-center justify-content-center">
                                                            <svg xmlns="http://www.w3.org/2000/svg" width="18" height="17" viewBox="0 0 18 17" fill="none">
                                                                <mask id="mask0_8554_1184" style="mask-type:alpha" maskUnits="userSpaceOnUse" x="0" y="0" width="18" height="17">
                                                                <rect x="0.781311" y="0.195312" width="16.2752" height="16.2752" fill="#D9D9D9"/>
                                                                </mask>
                                                                <g mask="url(#mask0_8554_1184)">
                                                                <path d="M4.38059 14.7752C4.04243 14.7752 3.75355 14.6554 3.51394 14.4159C3.27444 14.1763 3.1547 13.8874 3.1547 13.5493V5.95553C2.95566 5.85291 2.79286 5.70705 2.66627 5.51796C2.5398 5.32888 2.47656 5.11086 2.47656 4.8639V3.11652C2.47656 2.77836 2.59631 2.48947 2.8358 2.24987C3.07541 2.01037 3.3643 1.89062 3.70246 1.89062H14.1352C14.4734 1.89062 14.7623 2.01037 15.0019 2.24987C15.2414 2.48947 15.3611 2.77836 15.3611 3.11652V4.8639C15.3611 5.11086 15.2979 5.32888 15.1714 5.51796C15.0448 5.70705 14.882 5.85291 14.683 5.95553V13.5493C14.683 13.8874 14.5632 14.1763 14.3237 14.4159C14.0841 14.6554 13.7952 14.7752 13.4571 14.7752H4.38059ZM4.1719 6.0898V13.5167C4.1719 13.5862 4.19688 13.6438 4.24683 13.6895C4.2969 13.7351 4.35889 13.758 4.43281 13.758H13.4571C13.518 13.758 13.568 13.7384 13.6071 13.6993C13.6462 13.6602 13.6658 13.6102 13.6658 13.5493V6.0898H4.1719ZM3.70246 5.0726H14.1352C14.1961 5.0726 14.2461 5.05305 14.2852 5.01394C14.3244 4.97483 14.3439 4.92482 14.3439 4.8639V3.11652C14.3439 3.0556 14.3244 3.00559 14.2852 2.96648C14.2461 2.92738 14.1961 2.90783 14.1352 2.90783H3.70246C3.64154 2.90783 3.59153 2.92738 3.55242 2.96648C3.51332 3.00559 3.49376 3.0556 3.49376 3.11652V4.8639C3.49376 4.92482 3.51332 4.97483 3.55242 5.01394C3.59153 5.05305 3.64154 5.0726 3.70246 5.0726ZM7.0148 9.30449H10.8229V8.3329H7.0148V9.30449Z" fill="#1D1D78"/>
                                                                </g>
                                                            </svg>    
                                                        </span>
                                                        <p class="mb-0 font-13 ">Settled Expense</p>
                                                    </div>
                                                    <h5 class="mb-2 font-14 fw-bold mt-2">₹ {{ settledAmount }}</h5>
                                                    <p class="mb-0 font-12 week-count">
                                                        <ng-container *ngIf="amountChanges['settled'] >= 0; else negativeIcon">
                                                            <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 20 20" fill="none">
                                                                <path d="M13.1918 4.94434L15.0661 6.81861L11.072 10.8127L7.79819 7.53886L1.7334 13.6118L2.88743 14.7659L7.79819 9.8551L11.072 13.1289L16.2283 7.98082L18.1026 9.8551V4.94434H13.1918Z" fill="#22b783"/>
                                                            </svg>
                                                        </ng-container>
                                                        <ng-template #negativeIcon>
                                                            <svg xmlns="http://www.w3.org/2000/svg" width="21" height="20" viewBox="0 0 21 20" fill="none">
                                                                <path d="M14.0644 14.7659L15.9387 12.8916L11.9446 8.8975L8.67075 12.1713L2.60596 6.09837L3.75999 4.94434L8.67075 9.8551L11.9446 6.58126L17.1009 11.7294L18.9752 9.8551V14.7659H14.0644Z" fill="#F93C65"/>
                                                            </svg>
                                                        </ng-template>
                                                        <span [ngClass]="{'text-success': amountChanges['settled'] >= 0, 'text-danger': amountChanges['settled'] < 0}">
                                                            {{ getAbsolute(amountChanges['settled'] )| number:'1.0-0' }}% {{ amountChanges['settled'] >= 0 ? 'Up' : 'Down' }} past week
                                                        </span>
                                                    </p>
                                                     

                                                </div>
                                            </div>
                                            <div class="col-md-3">
                                                <div class="total-expanse p-3 border-rounded-2">
                                                    <div class="d-flex align-items-center gap-2">
                                                        <span class="total-expanse-icon d-flex align-items-center justify-content-center">
                                                            <svg xmlns="http://www.w3.org/2000/svg" width="18" height="17" viewBox="0 0 18 17" fill="none">
                                                                <mask id="mask0_8554_1184" style="mask-type:alpha" maskUnits="userSpaceOnUse" x="0" y="0" width="18" height="17">
                                                                <rect x="0.781311" y="0.195312" width="16.2752" height="16.2752" fill="#D9D9D9"/>
                                                                </mask>
                                                                <g mask="url(#mask0_8554_1184)">
                                                                <path d="M4.38059 14.7752C4.04243 14.7752 3.75355 14.6554 3.51394 14.4159C3.27444 14.1763 3.1547 13.8874 3.1547 13.5493V5.95553C2.95566 5.85291 2.79286 5.70705 2.66627 5.51796C2.5398 5.32888 2.47656 5.11086 2.47656 4.8639V3.11652C2.47656 2.77836 2.59631 2.48947 2.8358 2.24987C3.07541 2.01037 3.3643 1.89062 3.70246 1.89062H14.1352C14.4734 1.89062 14.7623 2.01037 15.0019 2.24987C15.2414 2.48947 15.3611 2.77836 15.3611 3.11652V4.8639C15.3611 5.11086 15.2979 5.32888 15.1714 5.51796C15.0448 5.70705 14.882 5.85291 14.683 5.95553V13.5493C14.683 13.8874 14.5632 14.1763 14.3237 14.4159C14.0841 14.6554 13.7952 14.7752 13.4571 14.7752H4.38059ZM4.1719 6.0898V13.5167C4.1719 13.5862 4.19688 13.6438 4.24683 13.6895C4.2969 13.7351 4.35889 13.758 4.43281 13.758H13.4571C13.518 13.758 13.568 13.7384 13.6071 13.6993C13.6462 13.6602 13.6658 13.6102 13.6658 13.5493V6.0898H4.1719ZM3.70246 5.0726H14.1352C14.1961 5.0726 14.2461 5.05305 14.2852 5.01394C14.3244 4.97483 14.3439 4.92482 14.3439 4.8639V3.11652C14.3439 3.0556 14.3244 3.00559 14.2852 2.96648C14.2461 2.92738 14.1961 2.90783 14.1352 2.90783H3.70246C3.64154 2.90783 3.59153 2.92738 3.55242 2.96648C3.51332 3.00559 3.49376 3.0556 3.49376 3.11652V4.8639C3.49376 4.92482 3.51332 4.97483 3.55242 5.01394C3.59153 5.05305 3.64154 5.0726 3.70246 5.0726ZM7.0148 9.30449H10.8229V8.3329H7.0148V9.30449Z" fill="#1D1D78"/>
                                                                </g>
                                                            </svg>    
                                                        </span>
                                                        <p class="mb-0 font-13 ">U-Settled Expense</p>
                                                    </div>
                                                    <h5 class="mb-2 font-14 fw-bold mt-2">₹ {{ unsettledAmount }}</h5>
                                                    <p class="mb-0 font-12 week-count">
                                                        <ng-container *ngIf="amountChanges['unsettled'] >= 0; else negativeIcon">
                                                            <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 20 20" fill="none">
                                                                <path d="M13.1918 4.94434L15.0661 6.81861L11.072 10.8127L7.79819 7.53886L1.7334 13.6118L2.88743 14.7659L7.79819 9.8551L11.072 13.1289L16.2283 7.98082L18.1026 9.8551V4.94434H13.1918Z" fill="#22b783"/>
                                                            </svg>
                                                        </ng-container>
                                                        <ng-template #negativeIcon>
                                                            <svg xmlns="http://www.w3.org/2000/svg" width="21" height="20" viewBox="0 0 21 20" fill="none">
                                                                <path d="M14.0644 14.7659L15.9387 12.8916L11.9446 8.8975L8.67075 12.1713L2.60596 6.09837L3.75999 4.94434L8.67075 9.8551L11.9446 6.58126L17.1009 11.7294L18.9752 9.8551V14.7659H14.0644Z" fill="#F93C65"/>
                                                            </svg>
                                                        </ng-template>
                                                        <span [ngClass]="{'text-success': amountChanges['unsettled'] >= 0, 'text-danger': amountChanges['unsettled'] < 0}">
                                                            {{ getAbsolute(amountChanges['unsettled']) | number:'1.0-0' }}% {{ amountChanges['unsettled'] >= 0 ? 'Up' : 'Down' }} past week
                                                        </span>
                                                    </p>
                                                </div>
                                            </div>
                                            <div class="col-md-3">
                                                <div class="total-expanse p-3 border-rounded-2">
                                                    <div class="d-flex align-items-center gap-2">
                                                        <span class="total-expanse-icon d-flex align-items-center justify-content-center">
                                                            <svg xmlns="http://www.w3.org/2000/svg" width="18" height="17" viewBox="0 0 18 17" fill="none">
                                                                <mask id="mask0_8554_1184" style="mask-type:alpha" maskUnits="userSpaceOnUse" x="0" y="0" width="18" height="17">
                                                                <rect x="0.781311" y="0.195312" width="16.2752" height="16.2752" fill="#D9D9D9"/>
                                                                </mask>
                                                                <g mask="url(#mask0_8554_1184)">
                                                                <path d="M4.38059 14.7752C4.04243 14.7752 3.75355 14.6554 3.51394 14.4159C3.27444 14.1763 3.1547 13.8874 3.1547 13.5493V5.95553C2.95566 5.85291 2.79286 5.70705 2.66627 5.51796C2.5398 5.32888 2.47656 5.11086 2.47656 4.8639V3.11652C2.47656 2.77836 2.59631 2.48947 2.8358 2.24987C3.07541 2.01037 3.3643 1.89062 3.70246 1.89062H14.1352C14.4734 1.89062 14.7623 2.01037 15.0019 2.24987C15.2414 2.48947 15.3611 2.77836 15.3611 3.11652V4.8639C15.3611 5.11086 15.2979 5.32888 15.1714 5.51796C15.0448 5.70705 14.882 5.85291 14.683 5.95553V13.5493C14.683 13.8874 14.5632 14.1763 14.3237 14.4159C14.0841 14.6554 13.7952 14.7752 13.4571 14.7752H4.38059ZM4.1719 6.0898V13.5167C4.1719 13.5862 4.19688 13.6438 4.24683 13.6895C4.2969 13.7351 4.35889 13.758 4.43281 13.758H13.4571C13.518 13.758 13.568 13.7384 13.6071 13.6993C13.6462 13.6602 13.6658 13.6102 13.6658 13.5493V6.0898H4.1719ZM3.70246 5.0726H14.1352C14.1961 5.0726 14.2461 5.05305 14.2852 5.01394C14.3244 4.97483 14.3439 4.92482 14.3439 4.8639V3.11652C14.3439 3.0556 14.3244 3.00559 14.2852 2.96648C14.2461 2.92738 14.1961 2.90783 14.1352 2.90783H3.70246C3.64154 2.90783 3.59153 2.92738 3.55242 2.96648C3.51332 3.00559 3.49376 3.0556 3.49376 3.11652V4.8639C3.49376 4.92482 3.51332 4.97483 3.55242 5.01394C3.59153 5.05305 3.64154 5.0726 3.70246 5.0726ZM7.0148 9.30449H10.8229V8.3329H7.0148V9.30449Z" fill="#1D1D78"/>
                                                                </g>
                                                            </svg>    
                                                        </span>
                                                        <p class="mb-0 font-13 ">Pending</p>
                                                    </div>
                                                    <h5 class="mb-2 font-14 fw-bold mt-2">₹ {{pendingAmount }}</h5>
                                                    <p class="mb-0 font-12 week-count">
                                                        <span class="text-black fw-semibold">{{pendingExpenseCountByWeek}} Request</span> in this week
                                                    </p>
                                                </div>
                                            </div>
                                            <div class="col-md-3">
                                                <div class="total-expanse p-3 border-rounded-2">
                                                    <div class="d-flex align-items-center gap-2">
                                                        <span class="total-expanse-icon d-flex align-items-center justify-content-center">
                                                            <svg xmlns="http://www.w3.org/2000/svg" width="18" height="17" viewBox="0 0 18 17" fill="none">
                                                                <mask id="mask0_8554_1184" style="mask-type:alpha" maskUnits="userSpaceOnUse" x="0" y="0" width="18" height="17">
                                                                <rect x="0.781311" y="0.195312" width="16.2752" height="16.2752" fill="#D9D9D9"/>
                                                                </mask>
                                                                <g mask="url(#mask0_8554_1184)">
                                                                <path d="M4.38059 14.7752C4.04243 14.7752 3.75355 14.6554 3.51394 14.4159C3.27444 14.1763 3.1547 13.8874 3.1547 13.5493V5.95553C2.95566 5.85291 2.79286 5.70705 2.66627 5.51796C2.5398 5.32888 2.47656 5.11086 2.47656 4.8639V3.11652C2.47656 2.77836 2.59631 2.48947 2.8358 2.24987C3.07541 2.01037 3.3643 1.89062 3.70246 1.89062H14.1352C14.4734 1.89062 14.7623 2.01037 15.0019 2.24987C15.2414 2.48947 15.3611 2.77836 15.3611 3.11652V4.8639C15.3611 5.11086 15.2979 5.32888 15.1714 5.51796C15.0448 5.70705 14.882 5.85291 14.683 5.95553V13.5493C14.683 13.8874 14.5632 14.1763 14.3237 14.4159C14.0841 14.6554 13.7952 14.7752 13.4571 14.7752H4.38059ZM4.1719 6.0898V13.5167C4.1719 13.5862 4.19688 13.6438 4.24683 13.6895C4.2969 13.7351 4.35889 13.758 4.43281 13.758H13.4571C13.518 13.758 13.568 13.7384 13.6071 13.6993C13.6462 13.6602 13.6658 13.6102 13.6658 13.5493V6.0898H4.1719ZM3.70246 5.0726H14.1352C14.1961 5.0726 14.2461 5.05305 14.2852 5.01394C14.3244 4.97483 14.3439 4.92482 14.3439 4.8639V3.11652C14.3439 3.0556 14.3244 3.00559 14.2852 2.96648C14.2461 2.92738 14.1961 2.90783 14.1352 2.90783H3.70246C3.64154 2.90783 3.59153 2.92738 3.55242 2.96648C3.51332 3.00559 3.49376 3.0556 3.49376 3.11652V4.8639C3.49376 4.92482 3.51332 4.97483 3.55242 5.01394C3.59153 5.05305 3.64154 5.0726 3.70246 5.0726ZM7.0148 9.30449H10.8229V8.3329H7.0148V9.30449Z" fill="#1D1D78"/>
                                                                </g>
                                                            </svg>    
                                                        </span>
                                                        <p class="mb-0 font-13 ">Rejected Expense</p>
                                                    </div>
                                                    <h5 class="mb-2 font-14 fw-bold mt-2">₹ {{rejectedAmount }}</h5>

                                                    <p class="mb-0 font-12 week-count">
                                                        <span class="text-black fw-semibold">{{rejectedExpenseCountByWeek}} Request</span> in this week
                                                    </p>
                                                </div>
                                            </div>
                                            <!-- <div class="col-md-3">
                                                <div class="total-expanse p-3 border-rounded-2">
                                                    <div class="d-flex align-items-center gap-2">
                                                        <span class="total-expanse-icon d-flex align-items-center justify-content-center">
                                                            <svg xmlns="http://www.w3.org/2000/svg" width="18" height="17" viewBox="0 0 18 17" fill="none">
                                                                <mask id="mask0_8554_1184" style="mask-type:alpha" maskUnits="userSpaceOnUse" x="0" y="0" width="18" height="17">
                                                                <rect x="0.781311" y="0.195312" width="16.2752" height="16.2752" fill="#D9D9D9"/>
                                                                </mask>
                                                                <g mask="url(#mask0_8554_1184)">
                                                                <path d="M4.38059 14.7752C4.04243 14.7752 3.75355 14.6554 3.51394 14.4159C3.27444 14.1763 3.1547 13.8874 3.1547 13.5493V5.95553C2.95566 5.85291 2.79286 5.70705 2.66627 5.51796C2.5398 5.32888 2.47656 5.11086 2.47656 4.8639V3.11652C2.47656 2.77836 2.59631 2.48947 2.8358 2.24987C3.07541 2.01037 3.3643 1.89062 3.70246 1.89062H14.1352C14.4734 1.89062 14.7623 2.01037 15.0019 2.24987C15.2414 2.48947 15.3611 2.77836 15.3611 3.11652V4.8639C15.3611 5.11086 15.2979 5.32888 15.1714 5.51796C15.0448 5.70705 14.882 5.85291 14.683 5.95553V13.5493C14.683 13.8874 14.5632 14.1763 14.3237 14.4159C14.0841 14.6554 13.7952 14.7752 13.4571 14.7752H4.38059ZM4.1719 6.0898V13.5167C4.1719 13.5862 4.19688 13.6438 4.24683 13.6895C4.2969 13.7351 4.35889 13.758 4.43281 13.758H13.4571C13.518 13.758 13.568 13.7384 13.6071 13.6993C13.6462 13.6602 13.6658 13.6102 13.6658 13.5493V6.0898H4.1719ZM3.70246 5.0726H14.1352C14.1961 5.0726 14.2461 5.05305 14.2852 5.01394C14.3244 4.97483 14.3439 4.92482 14.3439 4.8639V3.11652C14.3439 3.0556 14.3244 3.00559 14.2852 2.96648C14.2461 2.92738 14.1961 2.90783 14.1352 2.90783H3.70246C3.64154 2.90783 3.59153 2.92738 3.55242 2.96648C3.51332 3.00559 3.49376 3.0556 3.49376 3.11652V4.8639C3.49376 4.92482 3.51332 4.97483 3.55242 5.01394C3.59153 5.05305 3.64154 5.0726 3.70246 5.0726ZM7.0148 9.30449H10.8229V8.3329H7.0148V9.30449Z" fill="#1D1D78"/>
                                                                </g>
                                                            </svg>    
                                                        </span>
                                                        <p class="mb-0 font-13 ">Payroll Expense</p>
                                                    </div>
                                                    <h5 class="mb-2 font-14 fw-bold mt-2">₹ {{ payrollAmount }}</h5>
                                                    <p class="mb-0 font-12 week-count">
                                                        <ng-container *ngIf="amountChanges['payroll'] >= 0; else negativeIcon">
                                                            <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 20 20" fill="none">
                                                                <path d="M13.1918 4.94434L15.0661 6.81861L11.072 10.8127L7.79819 7.53886L1.7334 13.6118L2.88743 14.7659L7.79819 9.8551L11.072 13.1289L16.2283 7.98082L18.1026 9.8551V4.94434H13.1918Z" fill="#22b783"/>
                                                            </svg>
                                                        </ng-container>
                                                        <ng-template #negativeIcon>
                                                            <svg xmlns="http://www.w3.org/2000/svg" width="21" height="20" viewBox="0 0 21 20" fill="none">
                                                                <path d="M14.0644 14.7659L15.9387 12.8916L11.9446 8.8975L8.67075 12.1713L2.60596 6.09837L3.75999 4.94434L8.67075 9.8551L11.9446 6.58126L17.1009 11.7294L18.9752 9.8551V14.7659H14.0644Z" fill="#F93C65"/>
                                                            </svg>
                                                        </ng-template>
                                                        <span [ngClass]="{'text-success': amountChanges['payroll'] >= 0, 'text-danger': amountChanges['payroll'] < 0}">
                                                            {{ getAbsolute(amountChanges['payroll'] )| number:'1.0-0' }}% {{ amountChanges['payroll'] >= 0 ? 'Up' : 'Down' }} past week
                                                        </span>
                                                    </p>
                                                </div>
                                            </div> -->
                                        </div>
                                        <div class="row mt-3">
                                            <div class="col-md-6">
                                                <div class="categories-report border-rounded-2">
                                                    <div class="report-header p-3 d-flex align-items-center justify-content-between border-bottom">
                                                        <h5 class="mb-0 font-14 fw-semibold">Categories</h5>
                                                    </div>
                                                    <div class="p-3">
                                                        <div class="d-flex align-items-center justify-content-between">
                                                            <div>
                                                                <h5 class="mb-1 font-20 fw-semibold">{{ totalExpenseType }}
                                                                    <span class="font-13 fw-semibold">Types Of Expense</span>
                                                                </h5>
                                                                <p class="font-12 fw-normal color-basic mb-0">Defined By Your Organisation</p>
                                                            </div>
                                                            <!-- Half-circle chart container -->
                                                            <div class="expanse-type-chart" *ngIf="sChartLoaded && chartOptions">
                                                                <apx-chart 
                                                                  [series]="chartOptions.series"
                                                                  [chart]="chartOptions.chart"
                                                                  [labels]="chartOptions.labels"
                                                                  [colors]="chartOptions.colors"
                                                                  [dataLabels]="chartOptions.dataLabels"
                                                                  [fill]="chartOptions.fill"
                                                                  [plotOptions]="chartOptions.plotOptions"
                                                                  [legend]="chartOptions.legend"
                                                                  [tooltip]="chartOptions.tooltip">
                                                                </apx-chart>
                                                              </div>                                                              
                                                        </div>
                                                    
                                                        <div class="mt-4 categories-list">
                                                            <div *ngFor="let expense of expenseTypeSummery" class="d-flex align-items-center justify-content-between leave-count-list p-2 mb-3">
                                                                <div class="d-flex align-items-center gap-2">
                                                                    <!-- different color icon span -->
                                                                    <span class="earned-leave" [ngStyle]="{'background-color': getDynamicColors(expenseTypeSummery)[expenseTypeSummery.indexOf(expense)]}"></span>
                                                                    <p class="mb-0 text-black fw-semibold font-13">
                                                                        {{ expense.expenseTypeName }} <span class="fw-light">({{ expense.percentage }}%)</span>
                                                                    </p>
                                                                </div>
                                                                <h5 class="mb-0 font-13 text-black fw-semibold">₹{{ expense.approvedAmount | number }}</h5>
                                                            </div>
                                                        </div>
                                                    </div>
                                                    
                                                </div>
                                            </div>
                                            <div class="col-md-6">
                                                <div class="categories-report border-rounded-2">
                                                    <div class="report-header p-3 d-flex align-items-center justify-content-between border-bottom">
                                                        <h5 class="mb-0 font-14 fw-semibold">Top 5 Spending User</h5>
                                                    </div>

                                                    <div class="p-3 expanse-type-list">
                                                        
                                                        <div class="empty-file" style="margin-top: 5%; margin-bottom: 5%" *ngIf="topExpenseUser.length == 0 && !userLoader">
                                                            <nz-empty nzNotFoundImage="assets/images/no-data-found-img.svg"
                                                              [nzNotFoundContent]="contentTpl">
                                                              <ng-template #contentTpl>
                                                                <p class="mb-1 empty-detail font-16">
                                                                  No data for now
                                                                </p>
                                                              </ng-template>
                                                            </nz-empty>
                                                        </div>
        

                                                        
                                                        <div *ngIf="userLoader" >
                                                            <div class="client-report border p-3 mb-3" *ngFor="let item of [].constructor(5)">
                                                              <div class="d-flex align-items-center justify-content-between border-bottom pb-3">
                                                                <div class="d-flex align-items-center gap-2">
                                                                  <ngx-shimmer-loading [width]="'40px'" [height]="'40px'" [borderRadius]="'50%'"></ngx-shimmer-loading>
                                                                  <div>
                                                                    <ngx-shimmer-loading [width]="'120px'" [height]="'14px'" class="mb-2"></ngx-shimmer-loading>
                                                                    <ngx-shimmer-loading [width]="'200px'" [height]="'8px'"></ngx-shimmer-loading>
                                                                  </div>
                                                                </div>
                                                                <div class="text-end">
                                                                  <ngx-shimmer-loading [width]="'80px'" [height]="'14px'" class="mb-2"></ngx-shimmer-loading>
                                                                  <ngx-shimmer-loading [width]="'60px'" [height]="'10px'"></ngx-shimmer-loading>
                                                                </div>
                                                              </div>
                                                          
                                                              <div class="d-flex align-items-center justify-content-between pt-3">
                                                                <ngx-shimmer-loading [width]="'200px'" [height]="'10px'"></ngx-shimmer-loading>
                                                                <ngx-shimmer-loading [width]="'80px'" [height]="'10px'"></ngx-shimmer-loading>
                                                              </div>
                                                            </div>
                                                          </div>

                                                        <div class="client-report border p-3 mb-3" *ngFor="let user of topExpenseUser">
                                                            <div class="d-flex align-items-center justify-content-between border-bottom pb-3">
                                                                <div class="d-flex align-items-center gap-2">
                                                                    <img [src]="user.userImageUrl" class="img-40 radius-50 object-fit-cover">
                                                                    <div>
                                                                        <h5 (click)="this.helperService.routeToUserProfile(user.userUuid)"
                                                                        class="mb-0 font-14 fw-semibold pointer">{{ user.name }} </h5>
                                                                        <div class="mt-0" style="width:200px;" *ngIf="user.usagePercentage != 0">
                                                                            <nz-progress [nzPercent]="user.usagePercentage"
                                                                            [nzSuccessPercent]="0"
                                                                           ></nz-progress>
                                                                        </div>
                                                                        <div class="mt-1 font-13" style="width:200px;" *ngIf="user.usagePercentage == 0">
                                                                            <span>Do not have Wallet</span>
                                                                        </div>
                                                                    </div>
                                                                </div>
                                                                <div class="text-end">
                                                                    <h5 class="mb-1 font-14 fw-bold">₹{{ user.totalExpense | number:'1.2-2' }}</h5>
                                                                    <p class="mb-0 font-12 fw-normal color-basic">This week</p>
                                                                </div>
                                                            </div>
                                                            <div class="d-flex align-items-center justify-content-between pt-3">
                                                                <p class="mb-0 font-12 fw-normal color-basic">Total money spend till now <span class="text-black fw-semibold">₹{{ user.totalExpense | number:'1.2-2' }}</span></p>
                                                                <button class="btn p-0 fw-semibold font-12 collapsed view-details" type="button" data-bs-toggle="collapse" [attr.data-bs-target]="'#collapse' + user.userId">
                                                                    View details <i class="bi bi-caret-down-fill font-10"></i>
                                                                  </button>
                                                            </div>
                                                            <div class="mt-2 collapse" [id]="'collapse' + user.userId">
                                                                <div *ngFor="let expense of user.expenses" class="d-flex align-items-center justify-content-between mb-2">
                                                                  <p class="mb-0 fw-semibold text-black font-13">{{ expense.expenseType }}</p>
                                                                  <p class="mb-0 fw-normal text-black font-13">₹{{ expense.amount | number:'1.2-2' }}</p>
                                                                </div>
                                                              </div>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="assets-categories mt-3 border">
                                            <div class="categories-header p-3 d-flex align-items-center justify-content-between border-bottom">
                                                <h5 class="mb-0 font-14 fw-semibold">Departmental Budget Allocation</h5>
                                             </div>
                                            <div class="row p-3 pb-0">
                                                <div class="col-md-3" *ngFor="let team of teamWallets; let last = last">
                                                    <div class="border p-3 mb-3 border-rounded-2">
                                                    <h5 class="mb-1 font-14 fw-semibold">₹{{ team.amount | number }}</h5>
                                                    <p class="mb-0 font-12 fw-normal team-name">{{ team.teamName }}</p>
                                                </div>
                                                </div>
                                            </div>  
                                            <!-- View More -->
                                            <div class="d-flex align-items-center justify-content-end p-3 pt-0" *ngIf="teamWallets.length < totalTeam">
                                                <a class="view-all-btn text-primary fw-semibold font-14" (click)="loadMoreTeam()">
                                                  View More <i class="bi bi-chevron-down position-relative" style="top:2px"></i>
                                                </a>
                                              </div>
                                              <!-- View Less -->
                                              <div class="d-flex align-items-center justify-content-end p-3 pt-0" *ngIf="teamWallets.length >= totalTeam && totalTeam > itemsPerPage">
                                                <a class="view-all-btn text-primary fw-semibold font-14" (click)="hideTeam()">
                                                  View Less <i class="bi bi-chevron-up position-relative" style="top:2px"></i>
                                                </a>
                                              </div>
                                        </div>
                                </div>
                            </div>
                        </div>
                        
                        <div class="tab-pane fade" id="expense-request" role="tabpanel" aria-labelledby="employee-tab">
                            <div class="mt-3">
                                <div class="asset-assigned-search">
                                    <div class="d-flex justify-content-start align-items-center">
                                        <div class="search-filter ">
                                            <button type="button" id="statusDropdown" class="btn btn-secondary new-dropdown d-flex align-items-center justify-content-between" (click)="changeShowFilter(true)" >
                                                Filters 
                                                <svg xmlns="http://www.w3.org/2000/svg" width="23" height="23" viewBox="0 0 23 23" fill="none">
                                                    <mask id="mask0_7808_40" style="mask-type:alpha" maskUnits="userSpaceOnUse" x="0" y="0" width="23" height="23">
                                                    <rect x="0.262695" y="0.283112" width="22.4338" height="22.4338" fill="#1C1B1F"/>
                                                    </mask>
                                                    <g mask="url(#mask0_7808_40)">
                                                    <path d="M9.61057 17.1084V15.239H13.3495V17.1084H9.61057ZM5.87161 12.4347V10.5653H17.0885V12.4347H5.87161ZM3.06738 7.76104V5.89156H19.8927V7.76104H3.06738Z" fill="#1C1B1F"/>
                                                    </g>
                                                </svg>
                                            </button>
                                            
                                        </div>
                                        <div class="search-date d-flex align-items-center justify-content-between position-relative w-100">
                                                <div class="form-group w-100 position-relative">
                                                    <input type="text" id="searchText" #searchInput placeholder="Search by name.." [ngModel]="requestsSearch" (input)="searchByNameRequest($event)" class="form-control me-2 w-100" style="padding: 10px 45px;" />
                                                    <i class="bi bi-search search-icon d-flex align-items-center h-100" *ngIf="requestsSearch==''"></i>
                                                    <i class="bi bi-x search-icon d-flex align-items-center h-100 font-20" *ngIf="requestsSearch!=''" (click)="requestsSearch=''; databaseHelper.currentPage = 1; getExpenses();"></i>
                                                </div>
                                        </div>

                                        
                                        <div class="d-flex align-items-center gap-3 px-3">

                                            <button class="btn p-0 primaryBtnLink" data-bs-toggle="modal"
                                                data-bs-target="#sampleFileModal">
                                                <i class="bi bi-upload"></i>
                                                <span>Import</span>
                                            </button>
                                            
                                            <span class="calendar-separator"></span>
                                            
                                            <button *ngIf="!exportLoading" type="button" class="btn primaryBtnLink" (click)="export()">
                                                <i class="bi bi-download"></i>
                                                <span *ngIf="!exportLoading">Download</span>
                                                <div class="dot-opacity-loader" *ngIf="exportLoading">
                                                    <span></span>
                                                    <span></span>
                                                    <span></span>
                                                  </div>
                                            </button>
                                            
                                        </div>
                                    </div>
                                </div>
                                <div class="not-assign-filter filter-box p-0 border position-absolute bg-white" [ngClass]="{'d-none': !showFilter}">                                   
                                     <div class="d-flex align-items-center justify-content-between border-bottom p-3">
                                        <h5 class="mb-0 font-14 fw-semibold">Filter</h5>
                                        <span class="pointer lh-1" (click)="changeShowFilter(false)">
                                        <svg xmlns="http://www.w3.org/2000/svg" width="18" height="19" viewBox="0 0 18 19" fill="none" >
                                            <g opacity="0.8">
                                            <mask id="mask0_7729_258" style="mask-type:alpha" maskUnits="userSpaceOnUse" x="0" y="0" width="18" height="19">
                                            <rect y="0.5" width="18" height="18" fill="#D9D9D9"/>
                                            </mask>
                                            <g mask="url(#mask0_7729_258)">
                                            <path d="M4.8 14.75L3.75 13.7L7.95 9.5L3.75 5.3L4.8 4.25L9 8.45L13.2 4.25L14.25 5.3L10.05 9.5L14.25 13.7L13.2 14.75L9 10.55L4.8 14.75Z" fill="#1C1B1F"/>
                                            </g>
                                            </g>
                                        </svg>
                                        </span>
                                    </div>

                                    <div class="row p-3">

                                        <h5 class="font-14 mb-3">Date Range</h5>
                                        <div class="col-md-6 mb-3">
                                            <label for="from" class="pb-2">From  </label>
                                            <nz-date-picker [(ngModel)]="filters.fromDate" nzBorderless
                                            [nzDisabledDate]="disabledDateFrom" nzplaceholder="dd/mm/yyyy"></nz-date-picker>
                                        </div>
                                        <div class="col-md-6 mb-3">
                                            <label for="to" class="pb-2">To  </label>
                                            <nz-date-picker [(ngModel)]="filters.toDate"[(ngModel)]="filters.toDate" nzBorderless
                                            [nzDisabledDate]="disabledDateTo" nzplaceholder="dd/mm/yyyy"></nz-date-picker>
                                        </div>     
                                
                                        <div class="col-md-12 mb-3">
                                            <label for="status" class="pb-2">Status</label>
                                            <nz-select 
                                                [nzMaxTagCount]="3" 
                                                class="w-100 form-multiselect"
                                                [nzMaxTagPlaceholder]="tagPlaceHolder"
                                                nzMode="multiple" 
                                                nzPlaceHolder="Select Status"
                                                [(ngModel)]="selectedStatus"
                                                (ngModelChange)="updateStatusIds($event)">
                                                
                                                <!-- Dynamically Generate Options -->
                                                <nz-option *ngFor="let label of getStatusLabels()" 
                                                           [nzValue]="label" 
                                                           [nzLabel]="label">
                                                </nz-option>
                                        
                                            </nz-select>
                                            
                                            <!-- Placeholder for hidden selected items -->
                                            <ng-template #tagPlaceHolder let-selectedList>
                                                and {{ selectedList.length }} more selected
                                            </ng-template>
                                        </div>
                                        
                                    </div>
                                    <div class="p-3 border-top d-flex gap-2 align-items-center justify-content-end">
                                        <button class="btn cancel-btn mt-0" (click)="resetFilters()">Reset it</button>
                                        <button class="btn submitActionBtn" (click)="applyFilters()">Apply</button>
                                    </div>
                                </div> 
                            </div>

                            <div class="filter-bdg d-flex align-items-center gap-2 mt-3" *ngIf="selectedFilters.length > 0 || dateFilters.length>0">
                                <p *ngFor="let filter of selectedFilters" class="filter-pills d-flex align-items-center gap-2 pointer font-12 fw-semibold">
                                    {{ filter }}
                                    <i class="bi bi-x-lg pointer" (click)="removeFilter(filter)"></i>
                                </p>
                                <p *ngFor="let filter of dateFilters" class="filter-pills d-flex align-items-center gap-2 pointer font-12 fw-semibold">
                                    {{filter.key  | titlecase}} : {{ filter.value  | titlecase}}
                                    <i class="bi bi-x-lg pointer" (click)="removeDateFilter(filter)"></i>
                                  </p>
                            </div>
                            

                            <div class="mt-3">
                                <div class="table-responsive mb-4">
                                    <table class="table">
                                        <thead>
                                            <tr>
                                                <th>Date</th>
                                                <th>Employee Name</th>
                                                <th>Type</th>
                                                <th>Amount</th>
                                                <th>Settled </th>
                                                <th>Un-Settled </th>
                                                <th>Note</th>
                                                <th>Status</th>
                                                <th class="stickyColThend">Action</th>
                                            </tr>
                                        </thead>
                                        <!-- TO DO: Shimmer Loading Ui -->
                                        <tbody *ngIf="loading">
                                            <tr *ngFor="let item of [].constructor(10)"> 
                                                
                                                <td>
                                                    <ngx-shimmer-loading [width]="'100%'" [height]="'10px'"></ngx-shimmer-loading>
                                                </td>
                                                <td>
                                                    <ngx-shimmer-loading [width]="'100%'" [height]="'10px'"></ngx-shimmer-loading>
                                                </td>
                                                <td>
                                                    <ngx-shimmer-loading [width]="'100%'" [height]="'10px'"></ngx-shimmer-loading>
                                                </td>
                                                <td>
                                                    <ngx-shimmer-loading [width]="'100%'" [height]="'10px'"></ngx-shimmer-loading>
                                                </td>
                                                <td>
                                                    <ngx-shimmer-loading [width]="'100%'" [height]="'10px'"></ngx-shimmer-loading>
                                                </td>
                                                <td>
                                                    <ngx-shimmer-loading [width]="'100%'" [height]="'10px'"></ngx-shimmer-loading>
                                                </td>
                                                <td>
                                                    <ngx-shimmer-loading [width]="'100%'" [height]="'10px'"></ngx-shimmer-loading>
                                                </td>
                                                  <td>
                                                    <ngx-shimmer-loading [width]="'100%'" [height]="'10px'"></ngx-shimmer-loading>
                                                </td>
                                                <td>
                                                    <ngx-shimmer-loading [width]="'100%'" [height]="'10px'"></ngx-shimmer-loading>
                                                </td>
                                            </tr>
                                        </tbody>
                                        <!-- Shimmer Loading Ui End-->

                                  
                                           <tbody *ngIf="!loading">
                                            <ng-container *ngIf="expenseList.length == 0">
                                                <tr>
                                                    <td colspan="10">
                                                        <div class="empty-filenew" style="margin-top: 7%; margin-bottom: 7%">
                                                            <nz-empty nzNotFoundImage="assets/images/no-data-found-img.svg"
                                                                [nzNotFoundContent]="contentTpl">
                                                                <ng-template #contentTpl>
                                                                    <p class="mb-1 empty-filenew">No data for now</p>
                                                                </ng-template>
                                                            </nz-empty>
                                                        </div>
                                                    </td>
                                                </tr>
                                            </ng-container>
        
                                        <ng-container *ngIf="expenseList.length > 0">
                                            <tr *ngFor="let expense of expenseList; let i= index">
                                                <td class="text-left">
                                                    <span class="font-13 fw-semibold">{{expense.createdDate | date: 'dd MMM yyyy'}}</span>
                                                </td>
                                                <td (click)="this.helperService.routeToUserProfile(expense.uuid)" class="text-left pointer">
                                                    <span class="font-13 fw-semibold"> {{expense.employeeName}}</span>
                                                </td>
                                                <td class="text-left">
                                                    <span class="fw-normal font-13">{{expense.expenseType}} </span>
                                                </td>
                                                <td class="text-left">
                                                    <span class="font-13 fw-semibold"> ₹ {{expense.amount}} </span>
                                                </td>
                                                <td class="text-left">
                                                    <span class="font-13 fw-semibold"> ₹ {{expense.paidAmount == null ? 0 : expense.paidAmount }} </span>
                                                </td>
                                                <td class="text-left">
                                                    <span class="font-13 fw-semibold"> ₹ {{ (expense.amount - expense.paidAmount) === expense.amount ? 0 : expense.amount - expense.paidAmount}} </span>
                                                </td>
                                               
                                                <td>
                                                    <span class="white-space fw-normal font-13" nz-popover nzPopoverTitle="Note" [nzPopoverContent]="contentTemplate"
                                                    [nzPopoverOverlayStyle]="{'width':'300px'}" nzPopoverPlacement="top">{{  expense.notes || '--'}}</span>
                                                    <ng-template #contentTemplate>
                                                       <div>
                                                          {{expense.notes}}
                                                       </div>
                                                    </ng-template>
                                                 </td>
                                        
                                                <td class="text-left">
                                                    <span class="font-13 fw-semibold"
                                                        [ngClass]="{'text-warning': expense.status.id == 13 || expense.status.id == 46, 'text-success': expense.status.id == 14 || expense.status.id == 41 || expense.status.id == 40 || expense.status.id == 53,
                                                        'text-danger': expense.status.id == 15, 'text-primary': expense.status.id == 40 || expense.status.id == 48}" >
                                                        {{expense.status.response}}
                                                    </span>
                                                </td> 
                                                
                                                <td class="text-left stickyColTdend">
                                                    <div class="dropdown">
                                                        <button type="button" class="btnAction d-flex align-items-center justify-content-center pointer" type="button" data-bs-toggle="dropdown">
                                                            <i class="bi bi-three-dots-vertical font-15"></i>
                                                        </button>
                                                        <div class="dropdown-menu actionMenuList">
                                                            <li>
                                                                <a class="dropdown-item" (click)="openExpenseComponent(expense)"  data-bs-toggle="modal" data-bs-target="#approveModal">
                                                                    <i class="bi bi-eye"></i>  View request
                                                                </a>
                                                            </li>
                                                        </div>
                                                      </div>

                                                  </td>

                                            </tr>
                                        </ng-container>
                                    </tbody>
                                        
                                    </table>

                                    <div class="d-flex align-items-center justify-content-between pagination-box w-100 p-3 bg-white border-top" *ngIf="expenseList.length > 0 && totalItems > 9">
                                        <p class="mb-0">
                                            Showing {{ getStartIndex() }} to {{ getEndIndex() }} of {{ totalItems }} records
                                        </p>                                        
                                        <ngb-pagination class="pagition-box pagination-ul"  [collectionSize]="totalItems" [rotate]="true" (pageChange)="pageChanged($event)"
                                        [pageSize]="databaseHelper.itemPerPage"
                                        [(page)]="databaseHelper.currentPage" [maxSize]="4" [boundaryLinks]="true">
                                        </ngb-pagination>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="tab-pane fade" id="expense-policy" role="tabpanel" aria-labelledby="employee-tab">
                             <app-expense-policy></app-expense-policy>
                        </div>
                        <div class="tab-pane fade" id="expense-wallet" role="tabpanel" aria-labelledby="employee-tab">
                            <div class="mt-3">
                                <div class="asset-assigned-search">
                                    <div class="d-flex justify-content-start align-items-center">
                                        <div class="search-filter ">
                                            <button type="button" id="statusDropdown" class="btn btn-secondary new-dropdown d-flex align-items-center justify-content-between" (click)="companyWalletChangeShowFilter(true)" >
                                                Filters 
                                                <svg xmlns="http://www.w3.org/2000/svg" width="23" height="23" viewBox="0 0 23 23" fill="none">
                                                    <mask id="mask0_7808_40" style="mask-type:alpha" maskUnits="userSpaceOnUse" x="0" y="0" width="23" height="23">
                                                    <rect x="0.262695" y="0.283112" width="22.4338" height="22.4338" fill="#1C1B1F"/>
                                                    </mask>
                                                    <g mask="url(#mask0_7808_40)">
                                                    <path d="M9.61057 17.1084V15.239H13.3495V17.1084H9.61057ZM5.87161 12.4347V10.5653H17.0885V12.4347H5.87161ZM3.06738 7.76104V5.89156H19.8927V7.76104H3.06738Z" fill="#1C1B1F"/>
                                                    </g>
                                                </svg>
                                            </button>
                                            
                                        </div>
                                        <div class="search-date d-flex align-items-center justify-content-between position-relative w-100">
                                            <div class="form-group w-100 position-relative">
                                                <input type="text" id="searchText" #searchInput placeholder="Search by name.." [ngModel]="requestsSearch" (input)="searchByEmployeeName($event)" class="form-control me-2 w-100" style="padding: 10px 45px;" />
                                                <i class="bi bi-search search-icon d-flex align-items-center h-100" *ngIf="requestsSearch==''"></i>
                                                <i class="bi bi-x search-icon d-flex align-items-center h-100 font-20" *ngIf="requestsSearch!=''" (click)="requestsSearch=''; databaseHelper.currentPage = 1; getWalletUser();"></i>
                                            </div>
                                        </div>
                                        <!-- Button to open modal using ID -->
                                        <button type="button" class="btn primaryBtnLink filter-btn d-block text-center" 
                                            data-bs-toggle="modal" data-bs-target="#rechargeWalletModal" 
                                            (click)="openRechargeModel()">
                                            <i class="bi bi-plus font-18 position-relative" style="top: 2px;"></i>
                                            Recharge Wallet
                                        </button>
                                    </div>

                                    
                                </div>
                                <div class="not-assign-filter filter-box p-0 border position-absolute bg-white" [ngClass]="{'d-none': !showFilter}">                                   
                                     <div class="d-flex align-items-center justify-content-between border-bottom p-3">
                                        <h5 class="mb-0 font-14 fw-semibold"> Filter</h5>
                                        <span class="pointer lh-1" (click)="changeShowFilter(false)">
                                        <svg xmlns="http://www.w3.org/2000/svg" width="18" height="19" viewBox="0 0 18 19" fill="none" >
                                            <g opacity="0.8">
                                            <mask id="mask0_7729_258" style="mask-type:alpha" maskUnits="userSpaceOnUse" x="0" y="0" width="18" height="19">
                                            <rect y="0.5" width="18" height="18" fill="#D9D9D9"/>
                                            </mask>
                                            <g mask="url(#mask0_7729_258)">
                                            <path d="M4.8 14.75L3.75 13.7L7.95 9.5L3.75 5.3L4.8 4.25L9 8.45L13.2 4.25L14.25 5.3L10.05 9.5L14.25 13.7L13.2 14.75L9 10.55L4.8 14.75Z" fill="#1C1B1F"/>
                                            </g>
                                            </g>
                                        </svg>
                                        </span>
                                    </div>
                                    <div class="row p-3">
                                        <h5 class="font-14 mb-3">Date Range</h5>
                                        <div class="col-md-6 mb-3">
                                            <label for="from" class="pb-2">From  </label>
                                            <nz-date-picker [(ngModel)]="filters.fromDate" nzBorderless
                                            [nzDisabledDate]="disabledDateFrom" nzplaceholder="dd/mm/yyyy"></nz-date-picker>
                                        </div>
                                        <div class="col-md-6 mb-3">
                                            <label for="to" class="pb-2">To  </label>
                                            <nz-date-picker [(ngModel)]="filters.toDate"[(ngModel)]="filters.toDate" nzBorderless
                                            [nzDisabledDate]="disabledDateTo" nzplaceholder="dd/mm/yyyy"></nz-date-picker>
                                        </div>

                                        <div class="col-md-12 mb-3">
                                            <label for="status" class="pb-2">Select Employee</label>
                                            <nz-select 
                                                [nzMaxTagCount]="3" 
                                                class="w-100 form-multiselect"
                                                [nzMaxTagPlaceholder]="tagPlaceHolder"
                                                nzMode="multiple" 
                                                nzPlaceHolder="Select Employee"
                                                [(ngModel)]="requestedEmployeeId"
                                                (ngModelChange)="onEmployeeChange($event)"
                                            >
                                                <nz-option *ngFor="let user of users" 
                                                           [nzValue]="user.id" 
                                                           [nzLabel]="user.name">
                                                </nz-option>
                                            </nz-select>
                                        
                                            <ng-template #tagPlaceHolder let-selectedList>
                                                and {{ selectedList.length }} more selected
                                            </ng-template>
                                        </div>
                                        
                                    </div>
                                    <div class="p-3 border-top d-flex gap-2 align-items-center justify-content-end">
                                        <button class="btn cancel-btn mt-0" (click)="resetWalletFilters()">Reset it</button>
                                        <button class="btn submitActionBtn" (click)="applyWalletFilters()">Apply</button>
                                    </div>
                                </div> 
                            </div>

                            <div class="filter-bdg d-flex align-items-center gap-2 mt-3" *ngIf="requestedEmployeeList.length > 0 || dateFilters.length>0">
                                <p *ngFor="let employee of requestedEmployeeList" class="filter-pills d-flex align-items-center gap-2 pointer font-12 fw-semibold">
                                    {{ employee }}
                                    <i class="bi bi-x-lg pointer" (click)="removeWalletFilter(employee)"></i>
                                </p>
                                <p *ngFor="let filter of dateFilters" class="filter-pills d-flex align-items-center gap-2 pointer font-12 fw-semibold">
                                    {{filter.key  | titlecase}} : {{ filter.value  | titlecase}}
                                    <i class="bi bi-x-lg pointer" (click)="removeWalletDateFilter(filter)"></i>
                                  </p>
                            </div>

                            <div class="mt-3">
                                <div class="table-responsive mb-4">
                                    <table class="table">
                                        <thead>
                                            <tr>
                                                <th style="width: 60%;">Staff Name</th>
                                                <th>Last Recharge Date</th>
                                                <th>Wallet Amount</th>
                                                <th>Used Amount</th>
                                                <th>Action</th>
                                            </tr>
                                        </thead>
                                        <!-- TO DO: Shimmer Loading Ui -->
                                        <tbody *ngIf="loading">
                                            <tr *ngFor="let item of [].constructor(10)"> 
                                                <td>
                                                    <ngx-shimmer-loading [width]="'100%'" [height]="'10px'"></ngx-shimmer-loading>
                                                </td>
                                                <td>
                                                    <ngx-shimmer-loading [width]="'100%'" [height]="'10px'"></ngx-shimmer-loading>
                                                </td>
                                                <td>
                                                    <ngx-shimmer-loading [width]="'100%'" [height]="'10px'"></ngx-shimmer-loading>
                                                </td>
                                                <td>
                                                    <ngx-shimmer-loading [width]="'100%'" [height]="'10px'"></ngx-shimmer-loading>
                                                </td>
                                                <td>
                                                    <ngx-shimmer-loading [width]="'100%'" [height]="'10px'"></ngx-shimmer-loading>
                                                </td>
                                            </tr>
                                        </tbody>
                                        
                                        <tbody *ngIf="!loading">
                                            <ng-container *ngIf="walletUserList.length == 0">
                                                <tr>
                                                    <td colspan="8">
                                                        <div class="empty-filenew" style="margin-top: 7%; margin-bottom: 7%">
                                                            <nz-empty nzNotFoundImage="assets/images/no-data-found-img.svg"
                                                                [nzNotFoundContent]="contentTpl">
                                                                <ng-template #contentTpl>
                                                                    <p class="mb-1 empty-filenew">No data for now</p>
                                                                </ng-template>
                                                            </nz-empty>
                                                        </div>
                                                    </td>
                                                </tr>
                                            </ng-container>
                                            <ng-container *ngFor="let user of walletUserList; let i= index">
                                            <tr>
                                                
                                                <td>
                                                    <div class="d-flex align-items-center gap-3 wallet-transactions-list">
                                                        
                                                        <img onerror="this.src='./assets/images/broken-image-icon.jpg';"
                                                                    [src]="user.imageUrl || 'assets/images/user.png'" class="img-40 radius-50 object-fit-cover">
                                                        <div>
                                                            <!-- <h5 (click)="this.helperService.routeToUserProfile(user.userUuid)" -->
                                                            <h5 class="mb-1 font-14 fw-semibold pointer" (click)="this.helperService.routeToUserProfile(user.userUuid)">{{ user.userName}}</h5>
                                                            <p class="mb-0 font-12 fw-light color-basic">Department: <span class="fw-normal"> {{user.department}} </span></p>
                                                        </div>
                                                    </div>
                                                </td>
                                                <td class="fw-normal">
                                                    <span>
                                                        <h5 class="mb-1 font-13">{{user.formattedDate}}</h5>
                                                        <p class="mb-0 font-12 color-basic">{{user.formattedDay}}</p>
                                                    </span>    
                                                </td>
                                                <td class="fw-normal">₹ {{user.walletAmount}}</td>
                                                <td>
                                                    <span class="fw-normal">₹{{user.totalUsedAmount}}</span>
                                                </td>
                                                <td>
                                                    <button type="button" class="btn action-btn d-flex align-items-center justify-content-center collapsed " 
                                                        data-bs-toggle="collapse" href="#expenseList" role="button" aria-expanded="false" 
                                                        aria-controls="expenseList" (click)="toggleCollapse(i); fetchUserTransactionsByClick(user.userUuid);">
                                                        <i class="bi bi-chevron-down font-14 position-relative  " style="top: 1px;"></i>
                                                    </button>
                                                </td>                                                
                                            </tr>
                                            <tr class="collapse" [id]="'collapseExamplesheet' + i" [ngClass]="{'show': isExpanded(i)}">
                                                <td colspan="5" class="" style="padding: 0px !important;">
                                                    <div class="expense-list p-3">
                                                        <div class="d-flex align-items-centar justify-content-between">
                                                            <p class="mb-0 font-13 fw-normal color-basic">Latest Transaction of money on: <span class="fw-semibold text-black"> {{ lastTransactionDate ? (lastTransactionDate | date:'dd-MMM-yyyy') : 'N/A' }}</span> </p>
                                                            <p class="mb-0 font-13 fw-normal color-basic">Amount Used Till Now: <span class="text-primary fw-semibold">₹{{ totalUsedAmount }}</span></p>
                                                        </div>
                                                        <table class="table border mt-3">
                                                            <thead>
                                                                    <th class="">Expense Type</th>
                                                                    <th class="">Date Range</th>
                                                                    <th class="text-center">Expense Amount</th>
                                                                    <th class="text-center">Wallet Balance</th>
                                                                    <th class="text-center">Description</th>
                                                            </thead>
                                                            <tbody *ngIf="userTransactionLoading">
                                                                <tr *ngFor="let item of [].constructor(1)"> 
                                                                    <td>
                                                                        <ngx-shimmer-loading [width]="'100%'" [height]="'10px'"></ngx-shimmer-loading>
                                                                    </td>
                                                                    <td>
                                                                        <ngx-shimmer-loading [width]="'100%'" [height]="'10px'"></ngx-shimmer-loading>
                                                                    </td>
                                                                    <td>
                                                                        <ngx-shimmer-loading [width]="'100%'" [height]="'10px'"></ngx-shimmer-loading>
                                                                    </td>
                                                                    <td>
                                                                        <ngx-shimmer-loading [width]="'100%'" [height]="'10px'"></ngx-shimmer-loading>
                                                                    </td>
                                                                    <td>
                                                                        <ngx-shimmer-loading [width]="'100%'" [height]="'10px'"></ngx-shimmer-loading>
                                                                    </td>
                                                                </tr>
                                                            </tbody>
                                                            <tbody>
                                                                <tr *ngFor="let transaction of userTransactions; let i= index" >
                                                                    <td><span class="fw-normal font-13"> {{ getTransactionLabel(transaction) }}</span></td>
                                                                    <td><span class="fw-normal font-13">{{transaction.transactionDate | date:'yyyy-MM-dd HH:mm:ss'}}</span></td>
                                                                    <!-- <td class="text-center"><span class="fw-normal font-13">₹{{transaction.requestedAmount}}</span></td> -->
                                                                    <td class="text-center">
                                                                        <span 
                                                                            class="font-13 fw-semibold" 
                                                                            [ngClass]="{
                                                                                'text-success': transaction.type === 'CREDIT',
                                                                                'text-danger': transaction.type === 'DEBIT'
                                                                            }">
                                                                            <ng-container *ngIf="transaction.type === 'CREDIT'"> 
                                                                               +
                                                                            </ng-container>
                                                                            <ng-container *ngIf="transaction.type === 'DEBIT'"> 
                                                                                -
                                                                            </ng-container>
                                                                            ₹{{ transaction.requestedAmount }}
                                                                        </span>
                                                                    </td>
                                                                    <!-- <td class="text-center"><span class="fw-normal font-13">₹0</span></td> -->
                                                                    <td class="text-center">
                                                                        <span class="font-13 fw-semibold"> ₹{{ transaction.walletAmount }} </span>
                                                                    </td>
                                                                    <td class="text-center"><span class="fw-normal font-13">{{ transaction.description ? transaction.description : '---' }}</span></td>
                                                                </tr>
                                                            </tbody>
                                                        </table>

                                                    </div>
                                                </td>
                                            </tr>
                                            </ng-container>
                                        </tbody>
                                    </table>

                                    <div class="d-flex align-items-center justify-content-between pagination-box w-100 p-3 bg-white border-top" *ngIf="walletUserList.length > 0 && totalWalletUser > 9">
                                        <p class="mb-0">
                                            Showing {{ getStartIndex() }} to {{ walletgetEndIndex() }} of {{ totalWalletUser }} records
                                        </p>                                        
                                        <ngb-pagination class="pagition-box pagination-ul"  [collectionSize]="totalWalletUser" [rotate]="true" (pageChange)="walletPageChanged($event)"
                                        [pageSize]="databaseHelper.itemPerPage"
                                        [(page)]="databaseHelper.currentPage" [maxSize]="4" [boundaryLinks]="true">
                                        </ngb-pagination>
                                    </div>
                                </div>
                            </div>

                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>


<div class="modal fade" id="approveModal" tabindex="-1" role="dialog" aria-labelledby="exampleModalDefaultLabel"
   data-bs-backdrop="static" data-bs-keyboard="false" aria-hidden="true">
   
   <div class="modal-dialog modal-dialog-centered" [ngClass]="{'modal-xl':expenseData?.expense?.slipUrls?.length > 0,' modal-lg':expenseData?.expense?.slipUrls?.length == 0}" role="document">
    <div class="modal-content">
      <div class="modal-header">
         <h6 class="modal-title m-0" id="exampleModalDefaultLabel">
            Bill Snapshot 
         </h6>
         <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close" (click)="clearApproveModal();"
         #closeApproveModal></button>
      </div>
      <app-expense-request 
        *ngIf="showExpenseComponent" 
        [data]="expenseData" 
        (closeEvent)="onExpenseComponentClose()" 
        (actionCompleted)="showToast($event)">
     </app-expense-request>

    </div>
    </div>
</div>


<!-- Bootstrap Modal RECHARGE WALLET-->
<div class="modal fade" id="rechargeWalletModal" tabindex="-1" aria-labelledby="rechargeWalletModalLabel" aria-hidden="true" >
    <div class="modal-dialog modal-dialog-centered">
      <div class="modal-content">
        <div class="modal-header">
          <h5 class="modal-title" id="rechargeWalletModalLabel">Recharge Wallet</h5>
          <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close" #rechargeModalClose></button>
        </div>
        <div class="modal-body">
            <form #rechargeForm="ngForm">
                <!-- User Selection Dropdown -->
                <div class="mb-3">
                  <label for="userSelect" class="pb-2">Select User</label>
                  <nz-select nzShowSearch 
                    [(ngModel)]="selectedUserId" 
                    [nzPlaceHolder]="'Select a user'" 
                    class="w-100 form-control placeholder-line" 
                    required 
                    name="userId">
                    <nz-option 
                      *ngFor="let user of users" 
                      [nzValue]="user.uuid" 
                      [nzLabel]="user.name + ' (' + (user.email || 'N/A') + ')'">
                      <span class="fs-6">{{ user.name }}</span>
                    </nz-option>
                  </nz-select>
                  <div *ngIf="!selectedUserId && submitted" class="text-danger">Please select a user.</div>
                </div>
              
                <!-- Amount Input -->
                <div class="mb-3">
                  <label for="amount" class="pb-2">Amount</label>
                  <input 
                    type="number" 
                    class="form-control profile-input" 
                    id="amount" 
                    [(ngModel)]="amount" 
                    name="amount" 
                    required>
                  <div *ngIf="amount <= 0 && submitted" class="text-danger">Amount must be greater than 0.</div>
                </div>
              
                <!-- Remark Input -->
                <div class="mb-3">
                  <label for="remark" class="pb-2">Remark</label>
                  <textarea 
                    class="form-control nots-section" 
                    id="remark" 
                    [(ngModel)]="remark" 
                    name="remark" 
                    required>
                  </textarea>
                  <div *ngIf="!remark && submitted" class="text-danger">Remark is required.</div>
                </div>
              
                <div class="d-flex align-items-center gap-3 justify-content-end ">
                  <button type="button" class="btn cancel-btn mt-0" data-bs-dismiss="modal" (click)="resetFields()">Cancel</button>
                  <button type="button" class="btn submitActionBtn" (click)="rechargeWallet()">
                    <span *ngIf="!isLoadingHnS">Recharge</span>
                    <div class="dot-opacity-loader" *ngIf="isLoadingHnS">
                        <span></span>
                        <span></span>
                        <span></span>
                    </div>
                    
                </button>
                </div>
              </form>
              
        </div>
      </div>
    </div>
  </div>




<!-- Expense Import Modal -->
<div class="modal fade" id="sampleFileModal" tabindex="-1" aria-labelledby="sampleFileModalLabel" aria-hidden="true"
  #sampleFileModal>
  <div class="modal-dialog modal-xl modal-dialog-centered">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title" id="sampleFileModalLabel">Sample Excel File</h5>
        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"
          #closeButtonExcelModal></button>
      </div>
      <div class="modal-body">
        <ng-container *ngIf="
            !isShimmer &&
            onboardUserList.length == 0
          ">
          <div class="row">
            <div class="col-md-6">
              <div class="mb-0">
                <h4 class="text-black fw-semibold font-16">
                  Download the Sample Excel File!
                </h4>
                <div class="mt-4">
                    <div class="d-flex align-items-start gap-3">
                        <span class="info-count d-flex align-items-center justify-content-center font-13 fw-normal">1</span>
                        <p class="mb-0 font-13 w-80">
                            Look for the sample file titled "Sample_Data.xlsx" and click
                            on the download button to save it to your computer.
                          </p>
                    </div>
                    <div class="d-flex align-items-start gap-3 mt-3">
                        <span class="info-count d-flex align-items-center justify-content-center font-13 fw-normal">2</span>
                        <p class="mb-0 font-13 w-80">
                            Take a moment to review the existing data in the Excel file.
                            This will help you understand the structure and content of the
                            data before making any updates.
                          </p>
                    </div>
                    <div  class="d-flex align-items-start gap-3 mt-3 mb-3">
                        <span class="info-count d-flex align-items-center justify-content-center font-13 fw-normal">3</span>
                        <p class="mb-0 font-13 w-80">
                            <span class="text-primary">
                              <a class="text-primary" href="{{ sampleFileUrl }}">Download a sample Excel file</a>
                            </span>
                            , update its data, and upload it back with the updated content
                            on our platform
                          </p>
                    </div>
               
               
                
                </div>
              </div>
            </div>
            <div class="col-md-6" *ngIf="data.length == 0">
              <div class="mb-0 excel-upload-file-box d-flex align-items-center justify-content-center flex-column" >
                <input id="fileSelect" type="file" name="img[]" accept=".xlsx, .xls" class="input"
                  (change)="selectFile($event)" />
                <img src="assets/images/excel.svg" style="width: 50px" class="pb-3" />
                <p>
                  Drag file here to upload or,
                  <u><a class="text-primary" href="#!">Choose file</a></u>
                </p>
                <div *ngIf="isProgressToggle" class="spinner-border text-success" role="status"></div>
              </div>
            </div>
          </div>

          <div #attention class="create-password-warning waring-box p-3 mb-0 mt-4 ng-star-inserted text-start"
            *ngIf="mismatches.length > 0">
            <h4 class="alert-heading font-18 text-danger">Attention!!</h4>
            <ul style="padding-left: 15px;">
              <li class="mb-1" *ngIf="this.mismatches.length > 0">

                {{ mismatches }}
              </li>
              <li class="mb-1" *ngIf="isErrorToggle">Error: {{ errorMessage }}</li>
            </ul>
          </div>

          <div class="create-password-warning mb-0 mt-4 text-start" *ngIf="data.length > 0">

            <div *ngIf="data.length > 0">
              <h3 class="font-18 mb-2">Uploaded Data</h3>

              <div class="table-responsive">

                <table class="table excelUploadTable">
                  <thead>
                    <tr>
                      <th class="select-all-page" *ngFor="let col of fileColumnName">{{ col }}</th>
                    </tr>
                  </thead>
                  <tbody>

                    <tr *ngFor="let row of paginatedData; let i = index">


                      <!-- Fields with condition -->
                      <td *ngFor="let cell of fileColumnName; let j = index">

                        <ng-container *ngIf="cell != 'Payment Method' && cell != 'Lapse Remaining Amount'">
                          <input class="input-zorro p-2" *ngIf="!validateRowToggle" [(ngModel)]="row[j]" />
                          <input class="input-zorro p-2" *ngIf="validateRowToggle" [(ngModel)]="row[j]"
                            [ngClass]="{'error-border': invalidCells[i][j]}" />

                        </ng-container>

                        <ng-container *ngIf="cell === 'Payment Method'">
                          <nz-select [ngClass]="{'error-border': validateRowToggle && invalidCells[i][j]}"
                            id="paymentMethod" name="payment-method" class="w-100" [(ngModel)]="row[j]"
                            nzPlaceHolder="Select Method">
                            <nz-option [nzValue]="'ONLINE'" [nzLabel]="'ONLINE'"></nz-option>
                            <nz-option [nzValue]="'CASH'" [nzLabel]="'CASH'"></nz-option>
                          </nz-select>
                        </ng-container>

                        <ng-container *ngIf="cell === 'Lapse Remaining Amount'">
                          <nz-select [ngClass]="{'error-border': validateRowToggle && invalidCells[i][j]}"
                            id="lapseAmount" name="lapse-amount" class="w-100" [(ngModel)]="row[j]"
                            nzPlaceHolder="Select Type">
                            <nz-option [nzValue]="'YES'" [nzLabel]="'YES'"></nz-option>
                            <nz-option [nzValue]="'NO'" [nzLabel]="'NO'"></nz-option>
                          </nz-select>
                        </ng-container>

                      </td>

                    </tr>
                  </tbody>

                </table>

              </div>
              <div class="text-end border-top pt-3">
                <button *ngIf="!importToggle" type="button" class="btn p-0 next-btn btn-border"
                  (click)="saveFile()">Save Changes</button>
                <div class="dot-opacity-loader d-flex justify-content-end" *ngIf="importToggle">
                  <span></span>
                  <span></span>
                  <span></span>
                </div>

              </div>
            </div>

            <!-- <p *ngIf="isErrorToggle">Error: {{ errorMessage }}</p> -->
            <p *ngIf="!isErrorToggle" class="m-0"></p>
          </div>
        </ng-container>
        <ng-container *ngIf="isShimmer">
          <div class="">
            <div class="text-end">
              <ngx-shimmer-loading [width]="'30%'" [height]="'40px'" style="border-radius: 50%"></ngx-shimmer-loading>
            </div>
          </div>
          <div class="mt-3 mb-2" style="border: 1px solid #f5f5f5; padding: 5px; border-radius: 6px"
            *ngFor="let number of [1, 2, 3, 4, 5]">
            <div class="row mt-3">
              <div class="col-md-2">
                <div class="">
                  <ngx-shimmer-loading [width]="'100%'" [height]="'30px'"
                    style="border-radius: 50%"></ngx-shimmer-loading>
                </div>
              </div>
              <div class="col-md-2">
                <div class="">
                  <ngx-shimmer-loading [width]="'100%'" [height]="'30px'"
                    style="border-radius: 50%"></ngx-shimmer-loading>
                </div>
              </div>
              <div class="col-md-3">
                <div class="">
                  <ngx-shimmer-loading [width]="'100%'" [height]="'30px'"
                    style="border-radius: 50%"></ngx-shimmer-loading>
                </div>
              </div>
              <div class="col-md-3">
                <div class="">
                  <ngx-shimmer-loading [width]="'100%'" [height]="'30px'"
                    style="border-radius: 50%"></ngx-shimmer-loading>
                </div>
              </div>
              <div class="col-md-2">
                <div class="">
                  <ngx-shimmer-loading [width]="'100%'" [height]="'30px'"
                    style="border-radius: 50%"></ngx-shimmer-loading>
                </div>
              </div>
            </div>
          </div>
        </ng-container>
      </div>
    </div>
  </div>
</div>



  <a *ngIf="exportUrl !=''" href="{{exportUrl}}" id="exportUrlId" #expenseDownload></a>
  

                