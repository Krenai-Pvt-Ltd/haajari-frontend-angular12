<div class="page-wrapper">
  <div class="page-content-tab">
    <div class="container-fluid">
      <div class="empty-file">
        <div class="errorboxmain text-center" *ngIf="isLeaveErrorPlaceholder">
          <div class="errorboxinner">
            <div class="errorboxplaceholder mb-2">
              <img src="assets/images/signal.svg" style="width: 80px" />
            </div>
            <div class="">
              <h4>Something went wrong!</h4>
              <p class="mb-0"> An error occurred while processing your request. Please refresh the page and try again. </p>
            </div>
          </div>
        </div>
        <div class="errorboxmain" *ngIf="leaveSettingPlaceholder && !isLoading">
          <div class="errorboxinner">
            <div class="errorboxplaceholder mb-2">
              <img src="assets/images/empty-box.svg" style="width: 80px" />
            </div>
            <div class="">
              <p class="mb-0">Leave Settings Not Found</p>
            </div>
            <div class="add-filtter mt-2 mb-3" style="text-align: center">
              <a class="add-filtter" data-bs-toggle="modal" data-bs-target="#requestleave" (click)="emptyAddLeaveSettingRule(); preMethodCallToCreateLeaveTemplate()">
                <i class="bi bi-plus" style="font-size: 23px"></i> Create another template </a>
            </div>
          </div>
        </div>
      </div>
      <div class="row mt-2">
        <div class="col-md-4 mt-3 mb-3" *ngIf="
            (!leaveSettingPlaceholder && !isLeaveErrorPlaceholder) || isLoading
          ">
          <div class="form-roe-data">
            <h5>Leave Settings</h5>
            <p>This will be displayed on your profile.</p>
          </div>
        </div>
        <div class="col-md-7">
          <div class="row mb-3"></div>
          <div *ngIf="isLoading">
            <div class="">
              <div class="text-end">
                <ngx-shimmer-loading [width]="'40%'" [height]="'20px'" style="border-radius: 50%"></ngx-shimmer-loading>
              </div>
            </div>
            <div class="mt-3" style="
                border: 1px solid #f5f5f5;
                padding: 5px;
                border-radius: 6px;
                ">
              <div class="row" style="
                  border-bottom: 1px solid #f5f5f5;
                  padding-top: 10px;
                  padding-bottom: 10px;
                ">
                <div class="col-md-6">
                  <div class="">
                    <ngx-shimmer-loading [width]="'60%'" [height]="'20px'" style="border-radius: 50%"></ngx-shimmer-loading>
                  </div>
                </div>
                <div class="col-md-6">
                  <div class="text-end">
                    <ngx-shimmer-loading [width]="'60%'" [height]="'20px'" style="border-radius: 50%"></ngx-shimmer-loading>
                  </div>
                </div>
              </div>
              <div class="row mt-3">
                <div class="col-md-3">
                  <div class="">
                    <ngx-shimmer-loading [width]="'100%'" [height]="'15px'" style="border-radius: 50%"></ngx-shimmer-loading>
                  </div>
                </div>
              </div>
              <div class="row mt-2" style="
                  border-bottom: 1px solid #f5f5f5;
                  padding-top: 10px;
                  padding-bottom: 10px;
                ">
                <div class="col-md-4">
                  <div class="">
                    <ngx-shimmer-loading [width]="'100%'" [height]="'30px'" style="border-radius: 50%"></ngx-shimmer-loading>
                  </div>
                </div>
                <div class="col-md-4">
                  <div class="">
                    <ngx-shimmer-loading [width]="'100%'" [height]="'30px'" style="border-radius: 50%"></ngx-shimmer-loading>
                  </div>
                </div>
                <div class="col-md-4">
                  <div class="">
                    <ngx-shimmer-loading [width]="'100%'" [height]="'30px'" style="border-radius: 50%"></ngx-shimmer-loading>
                  </div>
                </div>
              </div>
              <div class="row mt-3">
                <div class="col-md-3">
                  <div class="">
                    <ngx-shimmer-loading [width]="'100%'" [height]="'15px'" style="border-radius: 50%"></ngx-shimmer-loading>
                  </div>
                </div>
              </div>
              <div class="row mt-2" style="
                  border-bottom: 1px solid #f5f5f5;
                  padding-top: 10px;
                  padding-bottom: 10px;
                ">
                <div class="col-md-4">
                  <div class="">
                    <ngx-shimmer-loading [width]="'100%'" [height]="'30px'" style="border-radius: 50%"></ngx-shimmer-loading>
                  </div>
                </div>
                <div class="col-md-4">
                  <div class="">
                    <ngx-shimmer-loading [width]="'100%'" [height]="'30px'" style="border-radius: 50%"></ngx-shimmer-loading>
                  </div>
                </div>
                <div class="col-md-4">
                  <div class="">
                    <ngx-shimmer-loading [width]="'100%'" [height]="'30px'" style="border-radius: 50%"></ngx-shimmer-loading>
                  </div>
                </div>
              </div>
              <div class="row mt-3">
                <div class="col-md-3">
                  <div class="">
                    <ngx-shimmer-loading [width]="'100%'" [height]="'15px'" style="border-radius: 50%"></ngx-shimmer-loading>
                  </div>
                </div>
              </div>
              <div class="row mt-2" style="
                  border-bottom: 1px solid #f5f5f5;
                  padding-top: 10px;
                  padding-bottom: 10px;
                ">
                <div class="col-md-4">
                  <div class="">
                    <ngx-shimmer-loading [width]="'100%'" [height]="'30px'" style="border-radius: 50%"></ngx-shimmer-loading>
                  </div>
                </div>
                <div class="col-md-4">
                  <div class="">
                    <ngx-shimmer-loading [width]="'100%'" [height]="'30px'" style="border-radius: 50%"></ngx-shimmer-loading>
                  </div>
                </div>
                <div class="col-md-4">
                  <div class="">
                    <ngx-shimmer-loading [width]="'100%'" [height]="'30px'" style="border-radius: 50%"></ngx-shimmer-loading>
                  </div>
                </div>
              </div>
              <div class="row mt-3">
                <div class="col-md-3">
                  <div class="">
                    <ngx-shimmer-loading [width]="'100%'" [height]="'15px'" style="border-radius: 50%"></ngx-shimmer-loading>
                  </div>
                </div>
              </div>
              <div class="row mt-2" style="
                  border-bottom: 1px solid #f5f5f5;
                  padding-top: 10px;
                  padding-bottom: 10px;
                ">
                <div class="col-md-4">
                  <div class="">
                    <ngx-shimmer-loading [width]="'100%'" [height]="'30px'" style="border-radius: 50%"></ngx-shimmer-loading>
                  </div>
                </div>
                <div class="col-md-4">
                  <div class="">
                    <ngx-shimmer-loading [width]="'100%'" [height]="'30px'" style="border-radius: 50%"></ngx-shimmer-loading>
                  </div>
                </div>
                <div class="col-md-4">
                  <div class="">
                    <ngx-shimmer-loading [width]="'100%'" [height]="'30px'" style="border-radius: 50%"></ngx-shimmer-loading>
                  </div>
                </div>
              </div>
              <div class="row mt-3">
                <div class="col-md-3">
                  <div class="">
                    <ngx-shimmer-loading [width]="'100%'" [height]="'15px'" style="border-radius: 50%"></ngx-shimmer-loading>
                  </div>
                </div>
              </div>
              <div class="row mt-2">
                <div class="col-md-4">
                  <div class="">
                    <ngx-shimmer-loading [width]="'100%'" [height]="'30px'" style="border-radius: 50%"></ngx-shimmer-loading>
                  </div>
                </div>
                <div class="col-md-4">
                  <div class="">
                    <ngx-shimmer-loading [width]="'100%'" [height]="'30px'" style="border-radius: 50%"></ngx-shimmer-loading>
                  </div>
                </div>
                <div class="col-md-4">
                  <div class="">
                    <ngx-shimmer-loading [width]="'100%'" [height]="'30px'" style="border-radius: 50%"></ngx-shimmer-loading>
                  </div>
                </div>
              </div>
            </div>
          </div>
          <div class="add-shift-main-box" *ngIf=" !leaveSettingPlaceholder && !isLeaveErrorPlaceholder && !isLoading">
            <div class="add-shift-box d-flex align-items-center justify-content-between p-3 pt-2 pb-2">
              <div class="">
                <h6 class="text-truncate mb-0">Leave</h6>
              </div>
              <div class="" *ngIf="!idFlag">
                <a class="add-shift-time-btn" data-bs-toggle="modal" data-bs-target="#requestleave" (click)="emptyAddLeaveSettingRule(); preMethodCallToCreateLeaveTemplate();">
                  <i class="bi bi-plus"></i> Create another template </a>
              </div>
            </div>
            <div class="shift-time p-3 m-3" *ngFor="let newLeaveSetting of leaveTemplates; let i = index">
              <div class="">
                <div class="d-flex align-items-center justify-content-between">
                  <div class="d-flex align-items-center gap-3">
                    <div class="">
                      <span class="automation-rules-icon d-flex align-items-center justify-content-center">
                        <img src="assets/images/rule-icon.svg" />
                      </span>
                    </div>
                    <div class="">
                      <h6 class="text-truncate mb-0">
                        {{ newLeaveSetting?.templateName }}
                      </h6>
                      <small class="text-muted">Define the leave rules for the employees</small>
                    </div>
                  </div>
                  <div class="d-flex align-items-center gap-3">
                    <div class="d-flex align-items-center gap-3">
                      <!-- <i class="bi bi-pencil pointer"></i><i class="bi bi-trash pointer text-danger"></i> -->
                      
                      <!-- <a href="" data-bs-toggle="modal" data-bs-target="#requestleave">
                        <i class="bi bi-pencil pointer" style="color: #6666f3" (click)="
                            getLeaveSettingInformationById(
                              newLeaveSetting.id,
                              true
                            )
                          "></i>
                      </a> -->

                      <!-- TODO: uncomment  -->
                      <!-- <a href="" data-bs-toggle="modal" data-bs-target="#requestleave">
                        <i class="bi bi-pencil pointer" style="color: #6666f3" (click)="getLeaveSettingInformationById(newLeaveSetting.id, true)"></i>
                      </a> -->

                      <!-- <a class="delete-rule" (click)="
                      deleteLeaveTemplate(
                            newLeaveSetting.id
                          )
                        " *ngIf="
                          !deleteLeaveTemplateLoader(
                            newLeaveSetting.id
                          )
                        ">
                        <i class="bi bi-trash pointer text-danger"></i>Bot
                      </a> -->
                      <a class="delete-rule" data-bs-toggle="modal" data-bs-target="#delete-leave" (click)="
                      getLeaveTemplateOrCategoryId(
                            newLeaveSetting.id, true
                          )
                        " *ngIf="
                          !deleteLeaveTemplateLoader(
                            newLeaveSetting.id
                          )
                        ">
                        <i class="bi bi-trash pointer text-danger"></i>
                      </a>

                      <div class="dot-opacity-loader" *ngIf="
                          deleteLeaveTemplateLoader(
                            newLeaveSetting.id
                          )
                        ">
                        <span></span>
                        <span></span>
                        <span></span>
                      </div>
                    </div>
                    <!-- <span class="staff-leave-setting bg-white">Staff - ({{ newLeaveSetting!.userLeaveRule.length || 0}})</span> -->
                    <span class="staff-leave-setting bg-white">Staff - {{newLeaveSetting.totalEmployees}}</span>
                    <span class="automation-rules-toogel-btn pointer" data-bs-toggle="collapse" [attr.data-bs-target]="'#multiCollapseExample' + i" role="button" [attr.aria-controls]="'multiCollapseExample' + i" [attr.aria-expanded]="i == activeIndex ? 'true' : 'false'" (click)="toggleCollapse(i)">
                      <i class="bi bi-chevron-down"></i>
                    </span>
                  </div>
                </div>
                <!-- class="col-md-4" -->
                <div class="collapse multi-collapse" [id]="'multiCollapseExample' + i" [class.show]="activeIndex === i">
                  <div class="row mt-3">
                    <div [ngClass]="{
                        'col-md-4':
                          newLeaveSetting.leaveTemplateCategoryRes.length > 2,
                        'col-md-6':
                          newLeaveSetting.leaveTemplateCategoryRes.length == 2,
                        'col-md-12':
                          newLeaveSetting.leaveTemplateCategoryRes.length == 1
                      }" *ngFor="
                        let category of newLeaveSetting.leaveTemplateCategoryRes">
                      <div class="custom-salary">
                        <div class="custom-salary-hedding p-3 d-flex align-items-center justify-content-between">
                          <h4 class="mb-0">
                            {{ category?.leaveName || "N/A" }}
                          </h4>
                          <div class="d-flex align-items-center gap-3">
                            <i class="bi bi-pencil pointer" data-bs-toggle="modal" data-bs-target="#requestleave" (click)="
                                editLeaveCategories(
                                  newLeaveSetting.id
                                )
                              "></i>
                            <!-- <i *ngIf="newLeaveSetting.leaveTemplateCategoryRes.length > 1" class="bi bi-trash pointer text-danger" (click)="deleteLeaveTemplateCategory(category.id)"></i> amit-->
                            <i *ngIf="newLeaveSetting.leaveTemplateCategoryRes.length > 1" data-bs-toggle="modal" data-bs-target="#delete-leave" (click)="getLeaveTemplateOrCategoryId(category.id, false)" class="bi bi-trash pointer text-danger" ></i>
                          
                          </div>
                        </div>
                        <div class="custom-salary-para p-3">
                          <div class="d-flex align-items-center justify-content-between mb-3">
                            <p class="mb-0">Leave Count</p>
                            <span style="color: #3f988f">{{ category?.leaveCount || "N/A"
                            }}</span>
                          </div>
                          <div class="d-flex align-items-center justify-content-between mb-3">
                            <p class="mb-0">Leave Rule</p>
                            <span style="color: #3f988f">{{ category?.unusedLeaveActionName || "N/A"
                            }}</span>
                          </div>
                          <div class="d-flex align-items-center justify-content-between">
                            <p class="mb-0">Carry Forward Limit</p>
                            <span style="color: #3f988f">{{ category?.unusedLeaveActionCount || "N/A"
                            }}</span>
                          </div>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>
          <div class="col-md-1"></div>
        </div>
      </div>
    </div>
  </div>
</div>
<div class="modal fade" id="requestleave" #requestleave tabindex="-1" role="dialog" aria-labelledby="requestLeave" aria-hidden="true">
  <div class="modal-dialog modal-lg modal-dialog-centered" role="document">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title" id="requestLeave" (click)="emptyAddLeaveSettingRule(); preMethodCallToCreateLeaveTemplate();" *ngIf="leaveSettingResponse.templateName == ''"> Create another template </h5>
        <h5 class="modal-title" id="requestLeave" (click)="emptyAddLeaveSettingRule()" *ngIf="leaveSettingResponse.templateName != ''">
          {{ leaveSettingResponse.templateName }}
        </h5>
        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close" id="requestLeaveCloseModel" #requestLeaveCloseModel></button>
      </div>
      <form #leaveSetForm="ngForm" >
        <div class="modal-body">
          <div class="">
            <ul id="myTab" role="tablist" class="nav nav-tabs">
              <li role="presentation" class="nav-item">
                <button id="home-tab" data-bs-toggle="tab" data-bs-target="#home" type="button" role="tab" aria-controls="home" aria-selected="true" class="nav-link active" #templateSettingTab> Template Setting </button>
              </li>
              <li role="presentation" class="nav-item">
                <button id="profile-tab" data-bs-toggle="tab" data-bs-target="#profile" type="button" role="tab" aria-controls="profile" aria-selected="false" class="nav-link" [disabled]="!leaveTemplateDefinitionForm.form.valid" #leaveCategoryTab> Leave Categories </button>
              </li>
              <li role="presentation" class="nav-item">
                <button id="staffSelection-tab" data-bs-toggle="tab" data-bs-target="#staffSelection" type="button" role="tab" aria-controls="staffSelection" aria-selected="false" class="nav-link" [disabled]="!form.valid" (click)="openStaffSelection()" #staffSelectionTab> Staff selection </button>
              </li>
            </ul>
            <div class="tab-content" id="myTabContent">
              
              <!-- <div class="tab-pane fade show active" id="home" role="tabpanel">
                <form nz-form #leaveTemplateDefinitionForm="ngForm">

                  <div class="row">
                    <div class="col-md-6">
                      <label for="empTypeId">Select Employee Type</label>
                      <nz-select style="width: 100%;" nzSize="large" nzPlaceHolder="Select Employee type" [(ngModel)]="employeeTypeId" (ngModelChange)="onEmployeeTypeChange($event)" name="empTypeId" #empTypeId="ngModel" required>
                        <nz-option *ngFor="let employeeType of employeeTypeList" [nzValue]="employeeType.id" [nzLabel]="employeeType.name"></nz-option>
                      </nz-select>
                      <div *ngIf="empTypeId.invalid && empTypeId.touched" class="invalid-feedback">
                        Employee Type is required.
                      </div>
                    </div>
                  
                    <div class="col-md-6">

                      <label for="genderId">Select Gender</label>
                      <nz-select style="width: 100%;" nzSize="large" nzPlaceHolder="Select gender" [(ngModel)]="selectedGenderId" (ngModelChange)="onGenderChange($event)" name="genderId" #genderId="ngModel" required>
                        <nz-option *ngFor="let gender of genders" [nzValue]="gender.id" [nzLabel]="gender.name"></nz-option>
                      </nz-select>

                      <div *ngIf="genderId.invalid && genderId.touched" class="invalid-feedback">
                        Gender is required.
                      </div>

                    </div>
                  </div>
                  

                  <div class="col-md-6 mt-3 mb-2" nz-form-item>
                    <label for="templateName" class="pb-2"> Template Name <i class="bi bi-exclamation-circle tolltip-icon" ngbTooltip="Provide a unique name for your organization's leave template. This name will be used to assign leave quotas to users who belong to this leave template." placement="right"></i>
                    </label>
                    <nz-form-control nzErrorTip="Please enter a valid name.">
                      <input nz-input [(ngModel)]="leaveTemplateRequest.name" placeholder="Enter the template name here" nzSize="large" minlength="3" maxlength="50" name="templateName" #templateName="ngModel" required />
                    </nz-form-control>
                  </div>
                  <div class="col-md-6 mt-2 mb-2" nz-form-item>
                    <label for="leaveRenewalCycle" class="pb-2"> Leave Quota Renew Cycle <i class="bi bi-exclamation-circle tolltip-icon" ngbTooltip="There are two main types: Monthly and Yearly. Monthly credits leave on a monthly basis. Yearly has two subtypes: 'All at Once', where leave is credited once at the start of the year, and 'Monthly Start', where the yearly leave quota is credited at the start of each month (you can choose a cycle from Jan to Dec or Apr to Mar of the next financial year)." placement="right"></i>
                    </label>

                    <nz-form-control nzErrorTip="Please select a valid renewal cycle.">
                      <nz-select style="width: 100%;" nzSize="large" nzPlaceHolder="Select leave quota renew cycle type" 
                        [(ngModel)]="leaveTemplateRequest.yearTypeName" (ngModelChange)="selectDateForLeaveTemplateRequest($event)" 
                        name="leaveRenewalCycle" #leaveRenewalCycle="ngModel" required>
                        <nz-option *ngFor="let yearType of yearTypeList" [nzValue]="yearType.name" [nzLabel]="yearType.name"></nz-option>
                      </nz-select>
                    </nz-form-control>
                    
                  </div>

                  <div class="col-md-6 mt-3 mb-2" nz-form-item>
                    <label for="leavePeriod" class="pb-2">Leave Period <i class="bi bi-exclamation-circle tolltip-icon" ngbTooltip="There are two main types: Monthly and Yearly. Monthly credits leave on a monthly basis. Yearly has two subtypes: 'All at Once', where leave is credited once at the start of the year, and 'Monthly Start', where the yearly leave quota is credited at the start of each month (you can choose a cycle from Jan to Dec or Apr to Mar of the next financial year)." placement="right"></i>
                    </label>
                    <nz-form-control nzErrorTip="Please select a valid date time.">
                      <div class="d-flex justify-content-between align-items-center">
                        <nz-date-picker [(ngModel)]="dateRange[0]" nzPlaceHolder="Start Date" [ngModelOptions]="{standalone : true}" 
                         [disabled]="!isCustomDateRange" (ngModelChange)="onStartDateChange($event)"  name="startDate" disabled></nz-date-picker>
                        <span class="text-muted p-3"> to </span>
                        <nz-date-picker [(ngModel)]="dateRange[1]" nzPlaceHolder="End Date" [ngModelOptions]="{standalone : true}" 
                        [disabled]="!isCustomDateRange" name="endDate" disabled></nz-date-picker>
                      </div>
                    </nz-form-control>
                  </div>

                  <div id="back-and-submit" class="d-flex justify-content-end align-items-end">
                    <button type="submit" [disabled]="!leaveTemplateDefinitionForm.form.valid" (click)="goToLeaveCategoryTab()" class="btn btn-outline-primary btn-round"> Next </button>
                  </div>
                </form>
              </div> -->

              <div class="tab-pane fade show active" id="home" role="tabpanel">
               

                <!-- <form nz-form #leaveTemplateDefinitionForm="ngForm" (ngSubmit)="onTemplateSubmit()"> -->
                <form nz-form #leaveTemplateDefinitionForm="ngForm" >

                  <div class="row">
                    <div class="col-md-6">
                      <div class="form-group" [class.has-error]="empTypeId.invalid && empTypeId.touched">
                        <label for="employeeTypeId">Employee Type</label>
                        <nz-form-control nzErrorTip="Please select an employee type.">
                          <nz-select style="width: 100%;" nzSize="large" nzPlaceHolder="Select Employee type"
                            [(ngModel)]="employeeTypeId" name="empTypeId" #empTypeId="ngModel" required>
                            <nz-option *ngFor="let employeeType of employeeTypeList" [nzValue]="employeeType.id"
                              [nzLabel]="employeeType.name">
                            </nz-option>
                          </nz-select>
                        </nz-form-control>
                        <div *ngIf="empTypeId.invalid && empTypeId.touched" class="invalid-feedback">
                          Employee Type is required.
                        </div>
                      </div>
                    </div>
                
                    <!-- <div class="col-md-6">
                      <label for="genderId">Select Gender</label>
                      <nz-select style="width: 100%;" nzSize="large" nzPlaceHolder="Select gender" [(ngModel)]="selectedGenderId"
                        (ngModelChange)="onGenderChange($event)" name="genderId" #genderId="ngModel" required>
                        <nz-option *ngFor="let gender of genders" [nzValue]="gender.id" [nzLabel]="gender.name">
                        </nz-option>
                      </nz-select>
                      <div *ngIf="genderId.invalid && genderId.touched" class="invalid-feedback">
                        Gender is required.
                      </div>
                    </div> -->

                  </div>
                
                  <!-- Template Name -->
                  <div class="col-md-6 mt-3 mb-2" nz-form-item>
                    <label for="templateName" class="pb-2"> Template Name
                      <i class="bi bi-exclamation-circle tolltip-icon"
                        ngbTooltip="Provide a unique name for your organization's leave template." placement="right">
                      </i>
                    </label>
                    <!-- <nz-form-control nzErrorTip="Please enter a valid name.">
                      <input nz-input [(ngModel)]="leaveTemplateRequest.name" placeholder="Enter the template name here" nzSize="large"
                        minlength="3" maxlength="50" name="templateName" #templateName="ngModel" required />
                    </nz-form-control>
                    <div *ngIf="templateName.invalid && templateName.touched" class="invalid-feedback">
                      Template name is required and must be between 3 and 50 characters.
                    </div> -->

                    <input nz-input [(ngModel)]="leaveTemplateRequest.name" placeholder="Enter the template name here" nzSize="large"
                    minlength="3" maxlength="50" name="templateName" #tempName="ngModel" required />
                    <div *ngIf="tempName?.touched">
                      <!-- <label *ngIf="tempName.errors?.required" id="cname-error" class="error mt-2 text-danger" for="cname"><sup>*</sup>Name is required.</label> -->
                      <label *ngIf="tempName.errors?.required" id="cname-error" class="error mt-2 text-danger" for="cname">
                        Name is required
                      </label>
                      <label *ngIf="tempName.errors?.minlength" id="cname-error" class="error mt-2 text-danger" for="cname">
                        Name must be at least 3 characters
                    </label>
                  </div>
             

                  </div>
                
                  <!-- Leave Quota Renewal Cycle -->
                  <div class="col-md-6 mt-2 mb-2" nz-form-item>
                    <label for="leaveRenewalCycle" class="pb-2"> Leave Quota Renew Cycle
                      <i class="bi bi-exclamation-circle tolltip-icon" ngbTooltip="Monthly or Yearly renewal cycle" placement="right">
                      </i>
                    </label>
                    <nz-form-control nzErrorTip="Please select a valid renewal cycle.">
                      <nz-select style="width: 100%;" nzSize="large" nzPlaceHolder="Select leave quota renew cycle type"
                        [(ngModel)]="leaveTemplateRequest.yearTypeName" (ngModelChange)="selectDateForLeaveTemplateRequest($event)"
                        name="leaveRenewalCycle" #leaveRenewalCycle="ngModel" required>
                        <nz-option *ngFor="let yearType of yearTypeList" [nzValue]="yearType.name" [nzLabel]="yearType.name">
                        </nz-option>
                      </nz-select>
                    </nz-form-control>
                    <div *ngIf="leaveRenewalCycle.invalid && leaveRenewalCycle.touched" class="invalid-feedback">
                      Renewal cycle is required.
                    </div>
                  </div>
                
                  <!-- Leave Period with Date Range -->
                  <div class="col-md-6 mt-3 mb-2" nz-form-item>
                    <label for="leavePeriod" class="pb-2">Leave Period
                      <i class="bi bi-exclamation-circle tolltip-icon" ngbTooltip="Specify the start and end dates for leave periods"
                        placement="right">
                      </i>
                    </label>
                    <nz-form-control nzErrorTip="Please select valid dates.">
                      <div class="d-flex justify-content-between align-items-center">
                        <nz-date-picker [(ngModel)]="dateRange[0]" nzPlaceHolder="Start Date" [disabled]="!isCustomDateRange"
                          (ngModelChange)="onStartDateChange($event)" name="startDate" #startDate="ngModel" required>
                        </nz-date-picker>
                        <span class="text-muted p-3"> to </span>
                        <nz-date-picker [(ngModel)]="dateRange[1]" nzPlaceHolder="End Date" [disabled]="!isCustomDateRange"
                          name="endDate" #endDate="ngModel" required>
                        </nz-date-picker>
                      </div>
                    </nz-form-control>
                    <div *ngIf="startDate.invalid && startDate.touched" class="invalid-feedback">
                      Start date is required.
                    </div>
                    <div *ngIf="endDate.invalid && endDate.touched" class="invalid-feedback">
                      End date is required.
                    </div>
                  </div>
                
                  <!-- Submit Button -->
                  <div id="back-and-submit" class="d-flex justify-content-end align-items-end">
                    <button type="submit" [disabled]="!leaveTemplateDefinitionForm.valid" (click)="goToLeaveCategoryTab()"
                      class="btn btn-outline-primary btn-round"> Next
                    </button>
                  </div>
                  <!-- <div id="back-and-submit" class="d-flex justify-content-end align-items-end">
                    <button type="submit" (click)="goToLeaveCategoryTab()"
                      class="btn btn-outline-primary btn-round"> Next </button>
                  </div> -->
                  
                </form>
                

                
              </div>
              

              <div class="tab-pane fade" id="profile" role="tabpanel">
                <div class="pt-3 pb-3">
                  <form [formGroup]="form">
                    <div formArrayName="categories">
                      <div *ngFor="let category of categories.controls; let i = index" class="form-group row mb-4 pb-2 position-relative" [formGroupName]="i">
                        
                        <div class="col-md-2">
                          <!-- Gender Selection -->
                          <label for="genderId">Select Gender</label>

                        <!-- <nz-select style="width: 100%;" nzSize="large" nzPlaceHolder="Select gender" formControlName="gender" 
                        (ngModelChange)="onGenderChange($event, i)" required>
                        <nz-option *ngFor="let gender of genders" [nzValue]="gender.id" [nzLabel]="gender.name"></nz-option>
                      </nz-select> -->

                      <nz-select style="width: 100%;" nzSize="large" nzPlaceHolder="Select gender" formControlName="gender" 
                      (ngModelChange)="onGenderChange($event, i)" required>
                      <!-- Loop through accrualTypes and display options -->
                      <nz-option *ngFor="let gender of genders" [nzValue]="gender.name" [nzLabel]="gender.name"></nz-option>
                    </nz-select>
                          
                          <!-- <div *ngIf="genderId.invalid && genderId.touched" class="invalid-feedback">
                            Gender is required.
                          </div> -->
                        </div>
                        
                        <div class="col-md-2">
                          <label class="mb-2">Leave Category Name</label>
                          <!-- <nz-select style="width: 100%;" nzSize="large" nzPlaceHolder="Select Leave Category Name" formControlName="leaveCategoryId" required>
                            <nz-option *ngFor="let leaveCategory of filteredLeaveCategories" [nzValue]="leaveCategory.id" [nzLabel]="leaveCategory.name"></nz-option>
                          </nz-select> -->

                          <!-- *ngIf="filteredLeaveCategories.length > 0" -->
                          <nz-select style="width: 100%;" nzSize="large" nzPlaceHolder="Select Leave Category Name" formControlName="leaveCategoryId" required>
                            <!-- <nz-option *ngFor="let leaveCategory of leaveCategoryList" [nzValue]="leaveCategory.id" [nzLabel]="leaveCategory.name"></nz-option> -->
                            <nz-option *ngFor="let leaveCategory of filteredLeaveCategories[i]" [nzValue]="leaveCategory.id" [nzLabel]="leaveCategory.name"></nz-option>
                          </nz-select>
                          
                          <!-- <input (keydown)="preventLeadingWhitespace($event)" id="leaveCategoryName" formControlName="leaveCategoryName" class="form-control" required [nzAutocomplete]="auto" placeholder="Select Leave Category Name" />
                          <nz-autocomplete #auto [nzDataSource]="filteredLeaveCategories"></nz-autocomplete> -->
                
                          <p class="errortxt mt-2 mb-0 text-danger" *ngIf="hasError('leaveCategoryId', i, 'required')">
                            <span style="white-space: nowrap;"><i class="bi bi-exclamation-circle"></i> Please fill this field.</span>
                          </p>
                        </div>
                        <div class="col-md-2">
                          <label class="mb-2">Leave Cycle</label>
                          <nz-select style="width: 100%;" nzSize="large" nzPlaceHolder="Select Leave Cycle"  formControlName="leaveCycleId" required>
                            <nz-option *ngFor="let leaveCycle of leaveCycleList" [nzValue]="leaveCycle.id" [nzLabel]="leaveCycle.name"></nz-option>
                          </nz-select>
                
                          <p class="errortxt mt-2 mb-0 text-danger" *ngIf="hasError('leaveCycleId', i, 'required')">
                            <span style="white-space: nowrap;"><i class="bi bi-exclamation-circle"></i> Please fill this field.</span>
                          </p>
                        </div>

                        <div class="col-md-2">

                          <label class="mb-2">Select Accrual Type</label>
                          <nz-select style="width: 100%;" nzSize="large" nzPlaceHolder="Select Accrual Type" formControlName="accrualTypeId" 
                              (ngModelChange)="onAccrualChange($event)" required>
                              <!-- Loop through accrualTypes and display options -->
                              <nz-option *ngFor="let accrualType of accrualTypes" [nzValue]="accrualType.id" [nzLabel]="accrualType.name"></nz-option>
                            </nz-select>
                        </div>
                      

                        <div class="col-md-2">
                          <label class="mb-2">Leave Count</label>
                          <nz-input-number style="width: 100%;" formControlName="leaveCount" nzPlaceHolder="Day Count" (ngModelChange)="generateDaysDropdown($event, i)" nzSize="large" [nzMin]="1" [nzMax]="10" [nzStep]="1" required></nz-input-number>
                          <p class="errortxt mt-2 mb-0 text-danger" *ngIf="hasError('leaveCount', i, 'required') || hasError('leaveCount', i, 'min')">
                            <span style="white-space: nowrap;"><i class="bi bi-exclamation-circle"></i> Please enter a valid number.</span>
                          </p>
                        </div>
                        <!-- <div class="col-md-2">
                          <label class="mb-2">Sandwich Rule</label>
                          <nz-select style="width: 100%;" nzSize="large" nzPlaceHolder="Select Leave Cycle" formControlName="isSandwichLeave" required>
                            <nz-option [nzValue]="true" [nzLabel]="booleanList[0]"></nz-option>
                            <nz-option [nzValue]="false" [nzLabel]="booleanList[1]"></nz-option>
                          </nz-select>
                        </div> -->
                        <div class="col-md-2">
                          <label class="mb-2" for="unusedLeaveActionId">Unused Leave Action</label>
                          <div class="dropdown" style="width: 100%">
                            <nz-select style="width: 100%;" nzSize="large" nzPlaceHolder="Unused leave action" formControlName="unusedLeaveActionId" required>
                              <nz-option *ngFor="let unusedLeaveAction of unusedLeaveActionList" [nzValue]="unusedLeaveAction.id" [nzLabel]="unusedLeaveAction.name"></nz-option>
                            </nz-select>
                          </div>
                        </div>
                        <div class="col-md-2">
                          <label class="mb-2">Unused Leave Count</label>
                          <!-- Use nz-select if the value of unusedLeaveAction is not 'Lapse' or empty -->
                          <nz-select style="width: 100%;" *ngIf="categories.controls[i]!.get('unusedLeaveActionId')?.value != LAPSE" formControlName="unusedLeaveActionCount" nzPlaceHolder="Select Days" nzSize="large" required>
                            <ng-container *ngFor="let day of daysCountArray[i]">
                              <nz-option *ngIf="day > 0" [nzValue]="day" [nzLabel]="day">
                                {{ day }}
                              </nz-option>
                            </ng-container>
                          </nz-select>
                        
                          <nz-input-number style="width: 100%;" formControlName="unusedLeaveActionCount" *ngIf="categories.controls[i]!.get('unusedLeaveActionId')?.value == LAPSE" nzPlaceHolder="N/A" (ngModelChange)="generateDaysDropdown($event, i)" nzSize="large" [nzMin]="1" [nzMax]="10" [nzStep]="1" [nzDisabled]="true"></nz-input-number>
                        </div>

                        <div class="leave-delet-btn" (click)="deleteRow(i)" *ngIf="i > 0">
                          <i class="bi bi-trash"></i>
                        </div>
                      </div>
                    </div>
                    <div id="back-and-submit">
                      <button type="button" class="btn add-filtter" (click)="addRow()">
                        <i class="bi bi-plus" style="font-size: 23px"></i> Add Leave Category
                      </button>
                      <button type="submit" class="btn btn-outline-primary btn-round" [disabled]="!form.valid" (click)="goToStaffSelectionTab()"> Next </button>
                    </div>
                  </form>
                </div>
                <!-- <div><button type="button" (click)="saveLeaveCategories()">Save</button></div> -->
              </div>

              <div class="tab-pane fade" id="staffSelection" role="tabpanel">
                <!-- <div class="tab-pane fade" id="profile" role="tabpanel"> -->
                <div class="staf-list-box mt-3">
                  <div class="row mb-3">
                    <div class="">
                      <div class="">
                        <ul id="myTab" role="tablist" class="nav nav-tabs" style="border-bottom: 0px">
                          <li role="presentation" class="nav-item">
                            <button id="home-tab" data-bs-toggle="tab" data-bs-target="#userlist" type="button" role="tab" aria-controls="userlist" aria-selected="true" class="nav-link staff-section active" #newStaffSelectionTab> Staff selection Userlist </button>
                          </li>
                          <li role="presentation" class="nav-item">
                            <button id="profile-tab" data-bs-toggle="tab" data-bs-target="#mapped" type="button" role="tab" aria-controls="mapped" aria-selected="false" class="nav-link staff-section"> Mapped Userlist </button>
                          </li>
                        </ul>
                        <div class="tab-content" id="myTabContent">
                          <div class="tab-pane fade show active" id="userlist" role="tabpanel">
                            <div class="mt-3">
                              <!-- border-bottom border-top pt-3 pb-3 -->
                              <div class="row border-top border-bottom pb-2 pt-2">
                                <div style="width: 30%; position: relative">
                                  <div class="dropdown" style="width: 100%">
                                    <button type="button" id="dropdownMenuButton1" data-bs-toggle="dropdown" aria-expanded="false" class="btn btn-secondary dropdown-toggle new-deopdown">
                                      {{ selectedTeamName }}
                                      <i class="bi bi-chevron-down" style="color: #444; font-size: 15px"></i>
                                    </button>
                                    <ul aria-labelledby="dropdownMenuButton1" class="dropdown-menu team-dropdown" style="
                                        width: 100%;
                                        max-height: 200px;
                                        overflow-y: auto;
                                      ">
                                      <li class="ng-star-inserted" (click)="selectTeam(0)">
                                        <a class="dropdown-item">All</a>
                                      </li>
                                      <li class="ng-star-inserted" *ngFor="let tn of teamNameList" (click)="selectTeam(tn.teamId)">
                                        <a class="dropdown-item">{{ tn.teamName
                                        }}</a>
                                      </li>
                                    </ul>
                                  </div>
                                </div>
                                <div class="col-md-8">
                                  <form novalidate="" role="search" (submit)="searchUsers()" class="searching ng-untouched ng-pristine ng-valid">
                                    <div class="form-group" style="position: relative; width: 300px">
                                      <input type="text" id="searchText" name="searchUsers" placeholder="Search by name and role" class="form-control me-2 ng-untouched ng-pristine ng-valid attendance-details-search" (keyup)="searchUsers()" [(ngModel)]="searchText" [ngModelOptions]="{ standalone: true }" style="padding: 10px 50px 10px 30px" />
                                      <button type="button" class="btn close-btn" (click)="clearSearchUsers()" *ngIf="crossFlag">
                                        <i class="bi bi-x"></i>
                                      </button>
                                      <i class="bi bi-search search-icon" style="
                                          position: absolute;
                                          top: 50%;
                                          transform: translateY(-50%);
                                          left: 10px;
                                        "></i>
                                    </div>
                                  </form>
                                </div>
                              </div>
                              <div class="errorboxmain text-center" *ngIf="
                                  (isStaffEmpty &&
                                    !searchUserPlaceholderFlag) ||
                                  (searchUserPlaceholderFlag && total == 0)
                                ">
                                <div class="errorboxinner">
                                  <div class="errorboxplaceholder mb-2">
                                    <img src="assets/images/empty-box.svg" style="width: 80px" />
                                  </div>
                                  <div class="">
                                    <h4>No Data Found</h4>
                                    <p class="mb-0"> We're unable to locate a record associated with the information you entered. </p>
                                  </div>
                                </div>
                              </div>
                              <div *ngIf="total !== 0">
                                <div class="" style="
                                    display: flex;
                                    justify-content: space-between;
                                    align-items: center;
                                  ">
                                  <div class="mt-3 d-flex" style="gap: 10px" *ngIf="selectedStaffIds!.length > 0">
                                    <ng-container *ngIf="
                                    selectedStaffIds!.length === total;
                                        else elseCondition2
                                      ">
                                      <span (click)="unselectAllUsers()" style="
                                          cursor: pointer;
                                          color: #eb5050;
                                          background-color: #fcf1f1;
                                          padding: 5px;
                                          border-radius: 5px;
                                        ">Clear all users <i class="bi bi-x"></i>
                                      </span>
                                      <span (click)="saveLeaveSettingRules(false)" style="
                                          cursor: pointer;
                                          color: #4761f6;
                                          background-color: #eef1ff;
                                          padding: 5px;
                                          border-radius: 5px;
                                        ">Add To Rule</span>
                                    </ng-container>
                                    <ng-template #elseCondition2>
                                      <span (click)="selectAllUsers(true)" style="
                                          cursor: pointer;
                                          color: #4761f6;
                                          background-color: #eef1ff;
                                          padding: 5px;
                                          border-radius: 5px;
                                        ">Select all {{ total }} users</span>
                                      <span (click)="saveLeaveSettingRules(false)" style="
                                          cursor: pointer;
                                          color: #4761f6;
                                          background-color: #eef1ff;
                                          padding: 5px;
                                          border-radius: 5px;
                                        ">Add To Rule</span>
                                    </ng-template>
                                  </div>
                                  <div class="pt-2" *ngIf="selectedStaffIds!.length !== 0">
                                    <ng-container *ngIf="
                                    selectedStaffIds!.length === total;
                                        else elseCondition1
                                      ">
                                      <span>All <b>{{ total }}</b> users selected </span>
                                    </ng-container>
                                    <ng-template #elseCondition1>
                                      <span>
                                        <b>{{ selectedStaffIds!.length
                                        }}</b> selected of <b>{{ total }}</b>
                                      </span>
                                      <span style="cursor: pointer" (click)="unselectAllUsers()">
                                        <i class="bi bi-x"></i>
                                      </span>
                                    </ng-template>
                                  </div>
                                </div>
                                <table class="table mt-3">
                                  <thead class="thead-light">
                                    <tr>
                                      <th style="width: 0%">
                                        <input type="checkbox" style="cursor: pointer" [ngModelOptions]="{
                                            standalone: true
                                          }" class="form-check-input" name="selectAllCheckbox" [(ngModel)]="isAllSelected" (change)="selectAll(isAllSelected)" />
                                      </th>
                                      <!-- <th style="width:25%; padding: 12px 15px;">S. No.</th> -->
                                      <th style="width: 25%; padding: 12px 15px"> Name </th>
                                      <th style="width: 50%; padding: 12px 15px"> Email </th>
                                      <th style="width: 25%; padding: 12px 15px"> Action </th>
                                    </tr>
                                  </thead>
                                  <tbody>
                                    <tr *ngFor="
                                        let staff of staffs
                                          | paginate
                                            : {
                                                itemsPerPage: itemPerPage,
                                                currentPage: pageNumber,
                                                totalItems: total
                                              }
                                      " style="border-bottom: 1px solid #dddddd">
                                      <td>
                                        <div class="form-check">
                                          <input type="checkbox" style="cursor: pointer" [ngModelOptions]="{
                                              standalone: true
                                            }" class="form-check-input" name="individualSelectionCheckbox" [(ngModel)]="staff.selected" (change)="
                                              checkIndividualSelection()
                                            " />
                                        </div>
                                      </td>
                                      <!-- <td style="padding: 12px 15px;">{{ i+1 }}</td> -->
                                      <td style="padding: 12px 15px">
                                        {{ staff.name }}
                                      </td>
                                      <td style="padding: 12px 15px">
                                        {{ staff.email != null ? staff.email : '- - -' }}
                                      </td>
                                      <td>
                                        <!-- && !addedUserFlag -->
                                        <!-- *ngIf="!staff.isAdded  -->
                                        <span *ngIf="!staff.isAdded">
                                          <div class="dot-opacity-loader" *ngIf="addEmployeeLoader(staff)">
                                            <span></span>
                                            <span></span>
                                            <span></span>
                                          </div>
                                          <button class="btn btn-outline-primary btn-sm editdata-edit" name="addButton" *ngIf="!addEmployeeLoader(staff)" (click)="addUser(staff.id, idOfLeaveSetting)"> Add </button>
                                        </span>
                                        <!-- && !addedUserFlag -->
                                        <span *ngIf="staff.isAdded">
                                          <button class="btn btn-outline-primary btn-sm editdata-edit" name="addedButton" [(ngModel)]="staff.selected" [ngModelOptions]="{standalone: true}"> Added </button>
                                        </span>
                                        <!-- <span *ngIf="staff.selected && addedUserFlag"><button class="btn btn-outline-primary btn-sm editdata-edit" [(ngModel)]="staff.selected"
                                                                                    >Added</button></span> -->
                                      </td>
                                    </tr>
                                  </tbody>
                                </table>
                              </div>
                            </div>
                            <div class="pagination pl-3" *ngIf="total > 8">
                              <p class="mb-0" style="padding-left: 15px"> Showing {{ getStartIndex() }} - {{ getEndIndex() }} of {{ total }} users </p>
                              <div class="row">
                                <div class="col-md-12">
                                  <nav aria-label="Page navigation example">
                                    <ul class="pagination justify-content-end">
                                      <li class="page-item" [class.disabled]="pageNumber == 1">
                                        <a class="page-link" href="javascript:void(0);" aria-label="Previous" (click)="changePage('prev')">
                                          <span aria-hidden="true">&laquo;</span>
                                        </a>
                                      </li>
                                      <li class="page-item" *ngFor="let page of getPages()" [class.active]="pageNumber == page">
                                        <a class="page-link" href="javascript:void(0);" (click)="changePage(page)">{{ page }}</a>
                                      </li>
                                      <li class="page-item" [class.disabled]="
                                          pageNumber == totalPages
                                        ">
                                        <a class="page-link" href="javascript:void(0);" aria-label="Next" (click)="changePage('next')">
                                          <span aria-hidden="true">&raquo;</span>
                                        </a>
                                      </li>
                                    </ul>
                                  </nav>
                                </div>
                              </div>
                            </div>
                          </div>
                          <!--  ######################    Stafff Selectiiiiooooonnnnnn -->
                          <div class="tab-pane fade" id="mapped" role="tabpanel">
                            <!-- || (searchSelectedUserPlaceholderFlag && totalUser==0) -->
                            <!-- {{isMappedStaffEmpty}} -->
                            <div class="mt-3">
                              <div class="row border-top border-bottom pb-2 pt-2">
                                <div style="width: 30%; position: relative">
                                  <div class="dropdown" style="width: 100%">
                                    <button type="button" id="dropdownMenuButton1" data-bs-toggle="dropdown" aria-expanded="false" class="btn btn-secondary dropdown-toggle new-deopdown">
                                      {{ selectedTeamNameOfAddedUsers }}
                                      <i class="bi bi-chevron-down" style="color: #444; font-size: 15px"></i>
                                    </button>
                                    <ul aria-labelledby="dropdownMenuButton1" class="dropdown-menu team-dropdown" style="
                                        width: 100%;
                                        max-height: 200px;
                                        overflow-y: auto;
                                      ">
                                      <li class="ng-star-inserted" (click)="
                                          selectTeamSearchForAddedUsers(0)
                                        ">
                                        <a class="dropdown-item">All</a>
                                      </li>
                                      <li class="ng-star-inserted" *ngFor="let tn of teamNameList" (click)="
                                          selectTeamSearchForAddedUsers(
                                            tn.teamId
                                          )
                                        ">
                                        <a class="dropdown-item">{{ tn.teamName
                                        }}</a>
                                      </li>
                                    </ul>
                                  </div>
                                </div>
                                <div class="col-md-6">
                                  <form novalidate="" role="search" (submit)="
                                      searchLeaveUsers(idOfLeaveSetting)
                                    " class="searching ng-untouched ng-pristine ng-valid">
                                    <div class="form-group" style="position: relative">
                                      <input type="text" id="searchTextUser" name="searchLeaveUsers" placeholder="Search by name and role" class="form-control me-2 ng-untouched ng-pristine ng-valid attendance-details-search" (keyup)="
                                          searchLeaveUsers(idOfLeaveSetting)
                                        " [(ngModel)]="searchTextUser" [ngModelOptions]="{ standalone: true }" style="padding: 10px 50px 10px 30px" />
                                      <button type="button" class="btn close-btn" (click)="clearSearchSelectedUsers()" *ngIf="crossFlagUser">
                                        <i class="bi bi-x"></i>
                                      </button>
                                      <i class="bi bi-search search-icon" style="
                                          position: absolute;
                                          top: 50%;
                                          transform: translateY(-50%);
                                          left: 10px;
                                        "></i>
                                    </div>
                                  </form>
                                </div>
                                <div class="col-md-6"></div>
                              </div>
                              <div class="errorboxmain text-center" *ngIf="
                                  (isMappedStaffEmpty &&
                                    !searchSelectedUserPlaceholderFlag) ||
                                  (searchSelectedUserPlaceholderFlag &&
                                    totalUser == 0)
                                ">
                                <div class="errorboxinner">
                                  <div class="errorboxplaceholder mb-2">
                                    <img src="assets/images/empty-box.svg" style="width: 80px" />
                                  </div>
                                  <div class="">
                                    <h4>No Data Found</h4>
                                    <p class="mb-0"> We're unable to locate a record associated with the information you entered. </p>
                                  </div>
                                </div>
                              </div>
                              <div *ngIf="totalUser != 0">
                                <div class="" style="
                                    display: flex;
                                    justify-content: space-between;
                                    align-items: center;
                                  ">
                                  <!-- <th style="width:0%; "><input type="checkbox" style="cursor: pointer;" class="form-check-input"
                                                                                       [(ngModel)]="isAllUsersSelected"
                                                                                       (change)="selectAllUsers($event)"></th> -->
                                  <div class="mt-3 d-flex" style="gap: 10px" *ngIf="selectedStaffIds!.length > 0">
                                    <ng-container *ngIf="
                                        selectedStaffIds!.length ===
                                          totalUser;
                                        else elseCondition2
                                      ">
                                      <span (click)="deleteAllUsers()" style="
                                          cursor: pointer;
                                          color: #eb5050;
                                          background-color: #fcf1f1;
                                          padding: 5px;
                                          border-radius: 5px;
                                        ">Remove All Users <i class="bi bi-x"></i>
                                      </span>
                                      <span (click)="unselectAllUsersUser()" style="
                                          cursor: pointer;
                                          color: #eb5050;
                                          background-color: #fcf1f1;
                                          padding: 5px;
                                          border-radius: 5px;
                                        ">Clear all users <i class="bi bi-x"></i>
                                      </span>
                                    </ng-container>
                                    <!-- selectAllUsersUser(true) -->
                                    <ng-template #elseCondition2>
                                      <span (click)="deleteAllUsers()" style="
                                          cursor: pointer;
                                          color: #4761f6;
                                          background-color: #eef1ff;
                                          padding: 5px;
                                          border-radius: 5px;
                                        ">Remove all users</span>
                                      <span (click)="selectAllUsersUser(true)" style="
                                          cursor: pointer;
                                          color: #4761f6;
                                          background-color: #eef1ff;
                                          padding: 5px;
                                          border-radius: 5px;
                                        ">Select all {{ totalUser }} users</span>
                                    </ng-template>
                                  </div>
                                  <div class="pt-2" *ngIf="
                                      selectedStaffIds!.length !== 0
                                    ">
                                    <ng-container *ngIf="
                                        selectedStaffIds!.length ===
                                          totalUser;
                                        else elseCondition1
                                      ">
                                      <span>All <b>{{ totalUser }}</b> users selected </span>
                                      <span style="cursor: pointer" (click)="unselectAllUsersUser()">
                                        <i class="bi bi-x"></i>
                                      </span>
                                    </ng-container>
                                    <ng-template #elseCondition1>
                                      <span>
                                        <b>{{ selectedStaffIds!.length
                                        }}</b> selected of <b>{{ totalUser }}</b>
                                      </span>
                                      <span style="cursor: pointer" (click)="unselectAllUsersUser()">
                                        <i class="bi bi-x"></i>
                                      </span>
                                    </ng-template>
                                  </div>
                                </div>
                                <table class="table mt-3">
                                  <thead class="thead-light">
                                    <tr>
                                      <th style="width: 0%">
                                        <input type="checkbox" style="cursor: pointer" [ngModelOptions]="{
                                            standalone: true
                                          }" class="form-check-input" name="selectAllByPage" [(ngModel)]="isAllSelectedUser" (change)="
                                            selectAllUser(isAllSelectedUser)
                                          " />
                                      </th>
                                      <!-- <th style="width:25%; padding: 12px 15px;">S. No.</th> -->
                                      <th style="width: 25%; padding: 12px 15px"> Name </th>
                                      <th style="width: 50%; padding: 12px 15px"> Email </th>
                                      <th style="width: 25%; padding: 12px 15px"> Action </th>
                                    </tr>
                                  </thead>
                                  <tbody>
                                    <tr *ngFor="
                                        let newstaff of staffsUser
                                          | paginate
                                            : {
                                                itemsPerPage: itemPerPageUser,
                                                currentPage: pageNumberUser,
                                                totalItems: totalUser
                                              }
                                      " style="border-bottom: 1px solid #dddddd">
                                      <td>
                                        <div class="form-check">
                                          <input type="checkbox" name="individualSelectionByPage" style="cursor: pointer" [ngModelOptions]="{
                                              standalone: true
                                            }" class="form-check-input" [(ngModel)]="newstaff.selected" (change)="
                                              checkIndividualSelectionUser()
                                            " />
                                        </div>
                                      </td>
                                      <!-- <td style="padding: 12px 15px;">{{ i+1 }}</td> -->
                                      <td style="padding: 12px 15px">
                                        {{ newstaff.name }}
                                      </td>
                                      <td style="padding: 12px 15px">
                                        {{ newstaff.email }}
                                      </td>
                                      <td>
                                        <button class="btn btn-outline-primary btn-sm remove" *ngIf="!deleteEmployeeLoader(newstaff)" (click)="deleteUser(newstaff.uuid)"> Remove </button>
                                        <div class="dot-opacity-loader" style="color: #eb5050" *ngIf="deleteEmployeeLoader(newstaff)">
                                          <span></span>
                                          <span></span>
                                          <span></span>
                                        </div>
                                      </td>
                                    </tr>
                                  </tbody>
                                </table>
                              </div>
                            </div>
                            <div class="pagination pl-3" *ngIf="totalUser > 8">
                              <p class="mb-0" style="padding-left: 15px"> Showing {{ getUserStartIndex() }} - {{ getUserEndIndex() }} of {{ totalUser }} users </p>
                              <div class="row">
                                <div class="col-md-12">
                                  <nav aria-label="Page navigation example">
                                    <ul class="pagination justify-content-end">
                                      <li class="page-item" [class.disabled]="pageNumberUser == 1">
                                        <a class="page-link" href="javascript:void(0);" aria-label="Previous" (click)="changeUserPage('prev')">
                                          <span aria-hidden="true">&laquo;</span>
                                        </a>
                                      </li>
                                      <li class="page-item" *ngFor="let userPage of getUserPages()" [class.active]="
                                          pageNumberUser == userPage
                                        ">
                                        <a class="page-link" href="javascript:void(0);" (click)="changeUserPage(userPage)">{{ userPage }}</a>
                                      </li>
                                      <li class="page-item" [class.disabled]="
                                          pageNumberUser == totalUserPages
                                        ">
                                        <a class="page-link" href="javascript:void(0);" aria-label="Next" (click)="changeUserPage('next')">
                                          <span aria-hidden="true">&raquo;</span>
                                        </a>
                                      </li>
                                    </ul>
                                  </nav>
                                </div>
                              </div>
                            </div>
                          </div>
                        </div>
                      </div>
                    </div>
                  </div>
                  <!-- *ngIf="staffs.length > 8" -->
                  <div id="back-and-submit">
                    <div class="modal-footer d-flex align-items-center justify-content-end">
                      <!-- <button type="button" class="btn btn-outline-primary">Back</button> -->
                    </div>
                    <div class="modal-footer d-flex align-items-center justify-content-end">
                      <button type="button" [disabled]="registerToggle" class="btn btn-outline-primary btn-round" (click)="registerLeaveTemplateMethodCall()"
                       *ngIf="!submitLeaveLoader"> Submit <i class="fa fa-spinner fa-spin" *ngIf="registerToggle"></i></button>
                      <div class="dot-opacity-loader" *ngIf="submitLeaveLoader">
                        <span></span>
                        <span></span>
                        <span></span>
                      </div>
                    </div>
                  </div>
                  <!-- </div> -->
                </div>
              </div>

            </div>
          </div>
        </div>
        <!-- <div class="modal-footer"><button type="button" class="btn btn-secondary" data-bs-dismiss="modal">
                        Cancel
                    </button><button type="submit" class="btn btn-primary">
                        Submit
                    </button></div> -->
      </form>
    </div>
  </div>
</div>


<button
  class="d-none"
  data-bs-toggle="modal"
  data-bs-target="#delete-leave"
></button>
<div
  class="modal fade"
  id="delete-leave"
  tabindex="-1"
  role="dialog"
  aria-hidden="true"
>
  <div
    class="modal-dialog modal-dialog-centered"
    style="max-width: 500px"
    role="document"
  >
    <div class="modal-content">
      <div class="modal-body p-0 delete-text">
        <div
          class="delete-image d-flex align-items-center justify-content-center pt-4 pb-4"
        >
          <div class="delete-close-btn">
            <button
              type="button"
              class="close-btn"
              data-bs-dismiss="modal"
              aria-label="Close"
              #closeButtonDeleteLeave
            >
              <svg
                xmlns="http://www.w3.org/2000/svg"
                width="30"
                height="30"
                viewBox="0 0 30 30"
                fill="none"
              >
                <mask
                  id="mask0_2031_1331"
                  style="mask-type: alpha"
                  maskUnits="userSpaceOnUse"
                  x="0"
                  y="0"
                  width="30"
                  height="30"
                >
                  <rect width="30" height="30" fill="#D9D9D9" />
                </mask>
                <g mask="url(#mask0_2031_1331)">
                  <path
                    d="M8 23.75L6.25 22L13.25 15L6.25 8L8 6.25L15 13.25L22 6.25L23.75 8L16.75 15L23.75 22L22 23.75L15 16.75L8 23.75Z"
                    fill="black"
                  />
                </g>
              </svg>
            </button>
          </div>
          <img src="/assets/images/delete-img.svg" style="width: 70px" />
        </div>
        <div class="bg-white p-4 text-center">
          <h5 class="alert-heading font-18 mb-2">
            Are you sure you want to delete <br />
            {{leaveTemplateId > 0 ? 'Leave Template ?' : 'Leave Category ?'}}
          </h5>
          <p class="font-11">You will not be able to recover this</p>

          <div class="mt-4 d-flex align-items-center flex-column">

            <button [disabled]="deleteToggle" class="btn continue-btn" *ngIf="leaveTemplateId > 0" (click)="deleteLeaveTemplate()">
              Continue <i class="fa fa-spinner fa-spin" *ngIf="deleteToggle"></i>
            </button>
            <!-- <button class="btn continue-btn" *ngIf="leaveTemplateId > 0" (click)="deleteLeaveTemplate()">Continue</button> -->
            <button [disabled]="deleteToggle" class="btn continue-btn" *ngIf="leaveTemplateId == 0" (click)="deleteLeaveTemplateCategory()">
              Continue <i class="fa fa-spinner fa-spin" *ngIf="deleteToggle"></i>
            </button>
            <button
              class="btn cancel-btn pt-2"
              type="button"
              data-bs-dismiss="modal"
              aria-label="Close"
            >
              Cancel
            </button>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>
